

============================== 2024-05-21 01:42:21.157804 | fb05a04f-7542-4cbd-897f-65055d7961b8 ==============================
[0m01:42:21.157804 [info ] [MainThread]: Running with dbt=1.4.7
[0m01:42:21.161774 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:42:21.162154 [debug] [MainThread]: Tracking: tracking
[0m01:42:21.179592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ed43a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ed4820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ed4400>]}
[0m01:42:21.194464 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m01:42:21.195827 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:42:21.196442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb05a04f-7542-4cbd-897f-65055d7961b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ed4850>]}
[0m01:42:21.791160 [debug] [MainThread]: 1603: static parser failed on example/films.sql
[0m01:42:21.795568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ed4640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7a51e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7a4220>]}
[0m01:42:21.796058 [debug] [MainThread]: Flushing usage events
[0m01:42:23.177865 [error] [MainThread]: Encountered an error:
Compilation Error in model films (models/example/films.sql)
  expected token 'end of print statement', got '{'
    line 1
      SELECT * FROM {{source{'destination_db', 'films'}}}


============================== 2024-05-21 01:44:55.153170 | c14b7364-ffe2-4d28-9338-d8c55f7acd28 ==============================
[0m01:44:55.153170 [info ] [MainThread]: Running with dbt=1.4.7
[0m01:44:55.157729 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:44:55.158130 [debug] [MainThread]: Tracking: tracking
[0m01:44:55.176106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m01:44:55.190216 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m01:44:55.191688 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:44:55.192261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c14b7364-ffe2-4d28-9338-d8c55f7acd28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217e0>]}
[0m01:44:55.766364 [debug] [MainThread]: 1603: static parser failed on example/films.sql
[0m01:44:55.769734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb706b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9de6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9de6110>]}
[0m01:44:55.770346 [debug] [MainThread]: Flushing usage events
[0m01:44:57.115183 [error] [MainThread]: Encountered an error:
Compilation Error in model films (models/example/films.sql)
  expected token 'end of print statement', got '{'
    line 1
      -- SELECT * FROM {{source{'destination_db', 'films'}}}


============================== 2024-05-21 01:45:10.821588 | 54852e0c-d59e-431c-9a80-0bfffb6f2253 ==============================
[0m01:45:10.821588 [info ] [MainThread]: Running with dbt=1.4.7
[0m01:45:10.825770 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:45:10.826177 [debug] [MainThread]: Tracking: tracking
[0m01:45:10.842811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb80>]}
[0m01:45:10.856972 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m01:45:10.858481 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:45:10.859132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '54852e0c-d59e-431c-9a80-0bfffb6f2253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79df30>]}
[0m01:45:11.428335 [debug] [MainThread]: 1603: static parser failed on example/films.sql
[0m01:45:11.431694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd0e75b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f2a830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f2aec0>]}
[0m01:45:11.432229 [debug] [MainThread]: Flushing usage events
[0m01:45:12.735768 [error] [MainThread]: Encountered an error:
Compilation Error in model films (models/example/films.sql)
  expected token 'end of print statement', got '{'
    line 1
      -- SELECT * FROM {{source{'destination_db', 'films'}}}


============================== 2024-05-21 01:46:52.486527 | 7fb260e7-35f7-4d77-9f0b-b4b389696ce1 ==============================
[0m01:46:52.486527 [info ] [MainThread]: Running with dbt=1.4.7
[0m01:46:52.491052 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:46:52.491471 [debug] [MainThread]: Tracking: tracking
[0m01:46:52.509476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m01:46:52.523304 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m01:46:52.524592 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:46:52.525117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7fb260e7-35f7-4d77-9f0b-b4b389696ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217e0>]}
[0m01:46:53.104826 [debug] [MainThread]: 1603: static parser failed on example/films.sql
[0m01:46:53.108321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb706b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9de6110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9de61a0>]}
[0m01:46:53.108950 [debug] [MainThread]: Flushing usage events
[0m01:46:54.414421 [error] [MainThread]: Encountered an error:
Compilation Error in model films (models/example/films.sql)
  expected token 'end of print statement', got '{'
    line 1
      -- SELECT * FROM {{source{'destination_db', 'films'}}}


============================== 2024-05-21 01:50:54.326374 | 00c48206-10de-41f9-b86f-9eff00ca55b9 ==============================
[0m01:50:54.326374 [info ] [MainThread]: Running with dbt=1.4.7
[0m01:50:54.330931 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:50:54.331354 [debug] [MainThread]: Tracking: tracking
[0m01:50:54.348323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m01:50:54.363072 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m01:50:54.364370 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:50:54.364954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '00c48206-10de-41f9-b86f-9eff00ca55b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217e0>]}
[0m01:50:54.938260 [debug] [MainThread]: 1603: static parser failed on example/films.sql
[0m01:50:54.941581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb706b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9de6110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9de61a0>]}
[0m01:50:54.942110 [debug] [MainThread]: Flushing usage events
[0m01:50:56.387308 [error] [MainThread]: Encountered an error:
Compilation Error in model films (models/example/films.sql)
  expected token 'end of print statement', got '{'
    line 1
      -- SELECT * FROM {{source{'destination_db', 'films'}}}


============================== 2024-05-21 01:51:04.664810 | b6ca9110-1434-4a56-8715-45258986431a ==============================
[0m01:51:04.664810 [info ] [MainThread]: Running with dbt=1.4.7
[0m01:51:04.669182 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:51:04.669682 [debug] [MainThread]: Tracking: tracking
[0m01:51:04.686336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79caf0>]}
[0m01:51:04.699960 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m01:51:04.701321 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:51:04.701921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b6ca9110-1434-4a56-8715-45258986431a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79df30>]}
[0m01:51:05.276001 [debug] [MainThread]: 1603: static parser failed on example/films.sql
[0m01:51:05.279378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd15a020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f80f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f83550>]}
[0m01:51:05.279908 [debug] [MainThread]: Flushing usage events
[0m01:51:06.620838 [error] [MainThread]: Encountered an error:
Compilation Error in model films (models/example/films.sql)
  expected token 'end of print statement', got '{'
    line 1
      -- SELECT * FROM {{source{'destination_db', 'films'}}}


============================== 2024-05-21 01:51:35.797001 | 43dfa1ab-8e7f-489f-891f-5402b6f18e61 ==============================
[0m01:51:35.797001 [info ] [MainThread]: Running with dbt=1.4.7
[0m01:51:35.801513 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:51:35.801917 [debug] [MainThread]: Tracking: tracking
[0m01:51:35.819492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7213c0>]}
[0m01:51:35.833476 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m01:51:35.834922 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:51:35.835504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '43dfa1ab-8e7f-489f-891f-5402b6f18e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721810>]}
[0m01:51:36.413713 [debug] [MainThread]: 1603: static parser failed on example/films.sql
[0m01:51:36.417109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb706200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9de6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9de60e0>]}
[0m01:51:36.417714 [debug] [MainThread]: Flushing usage events
[0m01:51:37.757698 [error] [MainThread]: Encountered an error:
Compilation Error in model films (models/example/films.sql)
  expected token 'end of print statement', got '{'
    line 1
      -- SELECT * FROM {{source{'destination_db', 'films'}}}


============================== 2024-05-21 01:55:10.681429 | aa24225c-5e6c-4f11-96f2-552d47ba1dff ==============================
[0m01:55:10.681429 [info ] [MainThread]: Running with dbt=1.4.7
[0m01:55:10.685738 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:55:10.686172 [debug] [MainThread]: Tracking: tracking
[0m01:55:10.702869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79caf0>]}
[0m01:55:10.716501 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m01:55:10.717858 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:55:10.718427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aa24225c-5e6c-4f11-96f2-552d47ba1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79df30>]}
[0m01:55:11.314753 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m01:55:11.331698 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m01:55:11.336835 [debug] [MainThread]: 1603: static parser failed on example/actors.sql
[0m01:55:11.339954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd15a020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9dd7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9dd7bb0>]}
[0m01:55:11.340482 [debug] [MainThread]: Flushing usage events
[0m01:55:12.898506 [error] [MainThread]: Encountered an error:
Compilation Error in model actors (models/example/actors.sql)
  expected token 'end of print statement', got '{'
    line 1
      SELECT * FROM {{source{'destination_db', 'actors'}}}


============================== 2024-05-21 01:55:47.231254 | d32421b2-f24a-49c8-9bda-7c60e26aa4c2 ==============================
[0m01:55:47.231254 [info ] [MainThread]: Running with dbt=1.4.7
[0m01:55:47.235536 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:55:47.235943 [debug] [MainThread]: Tracking: tracking
[0m01:55:47.252613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb80>]}
[0m01:55:47.266791 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m01:55:47.268275 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:55:47.268810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd32421b2-f24a-49c8-9bda-7c60e26aa4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79df30>]}
[0m01:55:47.870209 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m01:55:47.887162 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m01:55:47.890339 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m01:55:47.895634 [debug] [MainThread]: 1603: static parser failed on example/film_actors.sql
[0m01:55:47.898429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd0e75b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9dbfe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9dbfc10>]}
[0m01:55:47.898938 [debug] [MainThread]: Flushing usage events
[0m01:55:49.148007 [error] [MainThread]: Encountered an error:
Compilation Error in model film_actors (models/example/film_actors.sql)
  expected token 'end of print statement', got '{'
    line 1
      SELECT * FROM {{ source{'destination_db', 'film_actors'} }}


============================== 2024-05-21 01:56:09.220299 | c9ad8e21-8c27-49c6-a5f7-9b5d567e0e44 ==============================
[0m01:56:09.220299 [info ] [MainThread]: Running with dbt=1.4.7
[0m01:56:09.224646 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:56:09.225028 [debug] [MainThread]: Tracking: tracking
[0m01:56:09.242086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79efb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb20>]}
[0m01:56:09.256160 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m01:56:09.257521 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:56:09.258151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c9ad8e21-8c27-49c6-a5f7-9b5d567e0e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f730>]}
[0m01:56:09.853009 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m01:56:09.869949 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m01:56:09.873134 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m01:56:09.876629 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m01:56:09.998440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9ad8e21-8c27-49c6-a5f7-9b5d567e0e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f71300>]}
[0m01:56:10.010055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9ad8e21-8c27-49c6-a5f7-9b5d567e0e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e5b610>]}
[0m01:56:10.010818 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m01:56:10.011304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9ad8e21-8c27-49c6-a5f7-9b5d567e0e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e593c0>]}
[0m01:56:10.013501 [info ] [MainThread]: 
[0m01:56:10.016081 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:56:10.018832 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m01:56:10.030039 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m01:56:10.030530 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m01:56:10.030925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:56:10.087274 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m01:56:10.089549 [debug] [ThreadPool]: On list_destination_db: Close
[0m01:56:10.092284 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m01:56:10.098267 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m01:56:10.098735 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m01:56:10.099123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:56:10.105326 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m01:56:10.105761 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m01:56:10.106198 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:56:10.108323 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m01:56:10.111450 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m01:56:10.112310 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m01:56:10.119008 [debug] [MainThread]: Using postgres connection "master"
[0m01:56:10.120165 [debug] [MainThread]: On master: BEGIN
[0m01:56:10.120550 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:56:10.126324 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:56:10.126844 [debug] [MainThread]: Using postgres connection "master"
[0m01:56:10.127206 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:56:10.131730 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m01:56:10.133073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9ad8e21-8c27-49c6-a5f7-9b5d567e0e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9fa9390>]}
[0m01:56:10.133656 [debug] [MainThread]: On master: ROLLBACK
[0m01:56:10.134436 [debug] [MainThread]: Using postgres connection "master"
[0m01:56:10.134810 [debug] [MainThread]: On master: BEGIN
[0m01:56:10.135978 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:56:10.136442 [debug] [MainThread]: On master: COMMIT
[0m01:56:10.136835 [debug] [MainThread]: Using postgres connection "master"
[0m01:56:10.137187 [debug] [MainThread]: On master: COMMIT
[0m01:56:10.137950 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:56:10.138375 [debug] [MainThread]: On master: Close
[0m01:56:10.139158 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:56:10.139856 [info ] [MainThread]: 
[0m01:56:10.162046 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m01:56:10.162791 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m01:56:10.163706 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m01:56:10.164140 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m01:56:10.167554 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m01:56:10.170953 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-21 01:56:10.164717 => 2024-05-21 01:56:10.170868
[0m01:56:10.171486 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m01:56:10.211892 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m01:56:10.214996 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:56:10.215765 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m01:56:10.216294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:10.221775 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:56:10.222218 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:56:10.222583 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m01:56:10.225423 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m01:56:10.232800 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:56:10.233294 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m01:56:10.234546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:56:10.237436 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:56:10.237829 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m01:56:10.238791 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:56:10.260219 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m01:56:10.260770 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:56:10.261143 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m01:56:10.262470 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:56:10.267756 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m01:56:10.268207 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m01:56:10.270415 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m01:56:10.271936 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-21 01:56:10.171901 => 2024-05-21 01:56:10.271874
[0m01:56:10.272327 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m01:56:10.273418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ad8e21-8c27-49c6-a5f7-9b5d567e0e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d97e20>]}
[0m01:56:10.274637 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.11s]
[0m01:56:10.276815 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m01:56:10.277579 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m01:56:10.278199 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m01:56:10.279063 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m01:56:10.279448 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m01:56:10.282663 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m01:56:10.284152 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-21 01:56:10.279769 => 2024-05-21 01:56:10.284058
[0m01:56:10.284576 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m01:56:10.288951 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m01:56:10.290103 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:56:10.290444 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m01:56:10.290785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:10.297188 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:56:10.297685 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:56:10.298021 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m01:56:10.300308 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m01:56:10.303441 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:56:10.303868 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m01:56:10.304752 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:56:10.307301 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:56:10.307662 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m01:56:10.308523 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:56:10.310768 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m01:56:10.311279 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:56:10.311658 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m01:56:10.312867 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:56:10.315008 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m01:56:10.315352 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m01:56:10.316809 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m01:56:10.318106 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-21 01:56:10.284910 => 2024-05-21 01:56:10.318050
[0m01:56:10.318450 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m01:56:10.319255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ad8e21-8c27-49c6-a5f7-9b5d567e0e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e34070>]}
[0m01:56:10.319853 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.04s]
[0m01:56:10.320383 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m01:56:10.320821 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m01:56:10.321248 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m01:56:10.321958 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m01:56:10.322324 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m01:56:10.326018 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m01:56:10.327199 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-21 01:56:10.322574 => 2024-05-21 01:56:10.327078
[0m01:56:10.327674 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m01:56:10.332003 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m01:56:10.333017 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:56:10.333310 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m01:56:10.333582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:10.338841 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:56:10.339214 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:56:10.339500 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m01:56:10.341508 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m01:56:10.344278 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:56:10.344554 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m01:56:10.345226 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:56:10.347642 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:56:10.347897 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m01:56:10.348488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:56:10.350472 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m01:56:10.350732 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:56:10.350932 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m01:56:10.351691 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:56:10.353635 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m01:56:10.353886 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m01:56:10.355324 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m01:56:10.356551 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-21 01:56:10.328015 => 2024-05-21 01:56:10.356499
[0m01:56:10.356840 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m01:56:10.357779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ad8e21-8c27-49c6-a5f7-9b5d567e0e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8bf13f0>]}
[0m01:56:10.358422 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.04s]
[0m01:56:10.358942 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m01:56:10.360892 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m01:56:10.361335 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m01:56:10.362100 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m01:56:10.362425 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m01:56:10.366012 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m01:56:10.366901 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-05-21 01:56:10.362655 => 2024-05-21 01:56:10.366837
[0m01:56:10.367172 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m01:56:10.371271 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m01:56:10.371982 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m01:56:10.372238 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m01:56:10.372472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:10.377530 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:56:10.378055 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m01:56:10.378639 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m01:56:10.382863 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m01:56:10.385877 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m01:56:10.386228 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m01:56:10.387050 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:56:10.388958 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m01:56:10.389289 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m01:56:10.389565 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m01:56:10.390452 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:56:10.392516 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m01:56:10.392844 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m01:56:10.393570 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m01:56:10.394809 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-05-21 01:56:10.367350 => 2024-05-21 01:56:10.394754
[0m01:56:10.395152 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m01:56:10.395946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ad8e21-8c27-49c6-a5f7-9b5d567e0e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d087c0>]}
[0m01:56:10.396492 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.03s]
[0m01:56:10.397003 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m01:56:10.398836 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:56:10.399245 [debug] [MainThread]: Using postgres connection "master"
[0m01:56:10.399543 [debug] [MainThread]: On master: BEGIN
[0m01:56:10.399935 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:56:10.405752 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:56:10.406290 [debug] [MainThread]: On master: COMMIT
[0m01:56:10.406721 [debug] [MainThread]: Using postgres connection "master"
[0m01:56:10.407186 [debug] [MainThread]: On master: COMMIT
[0m01:56:10.407906 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:56:10.408263 [debug] [MainThread]: On master: Close
[0m01:56:10.408990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:56:10.409401 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m01:56:10.410037 [info ] [MainThread]: 
[0m01:56:10.410570 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m01:56:10.411362 [debug] [MainThread]: Command end result
[0m01:56:10.419880 [info ] [MainThread]: 
[0m01:56:10.420384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:56:10.420839 [info ] [MainThread]: 
[0m01:56:10.421257 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:56:10.421760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e5bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d29b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d2a710>]}
[0m01:56:10.422153 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 02:00:31.525237 | 45b4ef3b-b7dd-4b05-979e-4dcb10231bd6 ==============================
[0m02:00:31.525237 [info ] [MainThread]: Running with dbt=1.4.7
[0m02:00:31.529614 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:00:31.530108 [debug] [MainThread]: Tracking: tracking
[0m02:00:31.547928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m02:00:31.562885 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m02:00:31.599594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:00:31.600207 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:00:31.608824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45b4ef3b-b7dd-4b05-979e-4dcb10231bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e58e50>]}
[0m02:00:31.624179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45b4ef3b-b7dd-4b05-979e-4dcb10231bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a470>]}
[0m02:00:31.624762 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m02:00:31.625487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45b4ef3b-b7dd-4b05-979e-4dcb10231bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a4d0>]}
[0m02:00:31.627742 [info ] [MainThread]: 
[0m02:00:31.630369 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:00:31.633618 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m02:00:31.645356 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m02:00:31.645919 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m02:00:31.646496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:31.689770 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m02:00:31.693306 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m02:00:31.693763 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m02:00:31.694189 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m02:00:31.694517 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m02:00:31.694875 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m02:00:31.696369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:00:31.696769 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m02:00:31.697761 [info ] [MainThread]: 
[0m02:00:31.698340 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m02:00:31.698986 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  
[0m02:00:31.699605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e990c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e98fd0>]}
[0m02:00:31.700072 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 02:00:47.740996 | 756315ef-1282-409c-a866-c08223a398bf ==============================
[0m02:00:47.740996 [info ] [MainThread]: Running with dbt=1.4.7
[0m02:00:47.745645 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:00:47.746105 [debug] [MainThread]: Tracking: tracking
[0m02:00:47.762966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb20>]}
[0m02:00:47.777654 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m02:00:47.814452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:00:47.815019 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:00:47.823231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '756315ef-1282-409c-a866-c08223a398bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e50d00>]}
[0m02:00:47.835682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '756315ef-1282-409c-a866-c08223a398bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f52320>]}
[0m02:00:47.836351 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m02:00:47.836931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '756315ef-1282-409c-a866-c08223a398bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f52380>]}
[0m02:00:47.839301 [info ] [MainThread]: 
[0m02:00:47.841958 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:00:47.845056 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m02:00:47.857623 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m02:00:47.858274 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m02:00:47.858719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:47.909919 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m02:00:47.912234 [debug] [ThreadPool]: On list_destination_db: Close
[0m02:00:47.915051 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m02:00:47.921136 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m02:00:47.921580 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m02:00:47.921955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:00:47.928636 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:00:47.929214 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m02:00:47.929649 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:00:47.932002 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:00:47.933603 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m02:00:47.934471 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m02:00:47.941290 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:47.941806 [debug] [MainThread]: On master: BEGIN
[0m02:00:47.942184 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:00:47.947216 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:00:47.947702 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:47.948081 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:00:47.953085 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m02:00:47.954412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '756315ef-1282-409c-a866-c08223a398bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e8d0c0>]}
[0m02:00:47.954976 [debug] [MainThread]: On master: ROLLBACK
[0m02:00:47.955774 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:47.956115 [debug] [MainThread]: On master: BEGIN
[0m02:00:47.957321 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:00:47.957797 [debug] [MainThread]: On master: COMMIT
[0m02:00:47.958218 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:47.958573 [debug] [MainThread]: On master: COMMIT
[0m02:00:47.959310 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:00:47.959660 [debug] [MainThread]: On master: Close
[0m02:00:47.960425 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:00:47.961065 [info ] [MainThread]: 
[0m02:00:47.980308 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m02:00:47.981032 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m02:00:47.981994 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m02:00:47.982479 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m02:00:47.985726 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m02:00:47.987354 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-21 02:00:47.982843 => 2024-05-21 02:00:47.987258
[0m02:00:47.987751 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m02:00:48.026678 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m02:00:48.028569 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:00:48.028945 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m02:00:48.029264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:48.034277 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:00:48.034767 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:00:48.035105 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m02:00:48.037829 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m02:00:48.044247 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:00:48.044670 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m02:00:48.045442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:00:48.048016 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:00:48.048362 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m02:00:48.049149 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:00:48.069952 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m02:00:48.070505 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:00:48.070917 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m02:00:48.072184 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:00:48.077198 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:00:48.077556 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m02:00:48.079318 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:00:48.080809 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-21 02:00:47.988049 => 2024-05-21 02:00:48.080741
[0m02:00:48.081214 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m02:00:48.082118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '756315ef-1282-409c-a866-c08223a398bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d2bd60>]}
[0m02:00:48.083434 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.10s]
[0m02:00:48.085536 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m02:00:48.086218 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m02:00:48.087017 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m02:00:48.087866 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m02:00:48.088332 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m02:00:48.091367 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m02:00:48.092678 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-21 02:00:48.088709 => 2024-05-21 02:00:48.092604
[0m02:00:48.093567 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m02:00:48.098006 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m02:00:48.100608 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:00:48.100934 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m02:00:48.101280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:48.107389 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:00:48.107876 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:00:48.108327 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m02:00:48.110701 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m02:00:48.113703 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:00:48.114346 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m02:00:48.115566 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:00:48.118459 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:00:48.118949 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m02:00:48.119973 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:00:48.122296 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m02:00:48.122747 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:00:48.123164 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m02:00:48.124346 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:00:48.127687 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:00:48.128142 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m02:00:48.129820 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:00:48.131374 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-21 02:00:48.093954 => 2024-05-21 02:00:48.131314
[0m02:00:48.131756 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m02:00:48.132599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '756315ef-1282-409c-a866-c08223a398bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d841f0>]}
[0m02:00:48.133185 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.04s]
[0m02:00:48.133738 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m02:00:48.134242 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m02:00:48.134766 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m02:00:48.135543 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m02:00:48.135925 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m02:00:48.138724 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m02:00:48.139858 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-21 02:00:48.136216 => 2024-05-21 02:00:48.139796
[0m02:00:48.140213 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m02:00:48.144423 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m02:00:48.145590 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:00:48.145894 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m02:00:48.146213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:48.151529 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:00:48.151954 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:00:48.152277 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m02:00:48.154641 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m02:00:48.157582 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:00:48.157988 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m02:00:48.158973 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:00:48.161589 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:00:48.161967 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m02:00:48.162831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:00:48.165081 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m02:00:48.165621 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:00:48.166095 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m02:00:48.167790 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:00:48.170294 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:00:48.170770 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m02:00:48.172742 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:00:48.174497 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-21 02:00:48.140479 => 2024-05-21 02:00:48.174436
[0m02:00:48.174994 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m02:00:48.175954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '756315ef-1282-409c-a866-c08223a398bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d841f0>]}
[0m02:00:48.176619 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.04s]
[0m02:00:48.177249 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m02:00:48.179115 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m02:00:48.179542 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m02:00:48.180393 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m02:00:48.180835 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m02:00:48.184580 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m02:00:48.186136 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-05-21 02:00:48.181155 => 2024-05-21 02:00:48.186054
[0m02:00:48.186561 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m02:00:48.190826 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m02:00:48.192031 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:00:48.192428 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m02:00:48.192736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:48.198248 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:00:48.198772 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:00:48.199225 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m02:00:48.203070 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m02:00:48.205997 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:00:48.206402 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m02:00:48.207246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:00:48.209131 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m02:00:48.209445 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:00:48.209743 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m02:00:48.210816 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:00:48.212945 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:00:48.213261 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m02:00:48.214012 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:00:48.216331 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-05-21 02:00:48.186880 => 2024-05-21 02:00:48.216276
[0m02:00:48.216703 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m02:00:48.217737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '756315ef-1282-409c-a866-c08223a398bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff839ec50>]}
[0m02:00:48.218377 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.04s]
[0m02:00:48.218959 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m02:00:48.220417 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:00:48.220821 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:48.221208 [debug] [MainThread]: On master: BEGIN
[0m02:00:48.221546 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:00:48.227147 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:00:48.227615 [debug] [MainThread]: On master: COMMIT
[0m02:00:48.227963 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:48.228319 [debug] [MainThread]: On master: COMMIT
[0m02:00:48.229101 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:00:48.229570 [debug] [MainThread]: On master: Close
[0m02:00:48.230303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:00:48.230631 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m02:00:48.231365 [info ] [MainThread]: 
[0m02:00:48.231865 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m02:00:48.232643 [debug] [MainThread]: Command end result
[0m02:00:48.240221 [info ] [MainThread]: 
[0m02:00:48.240856 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:00:48.241345 [info ] [MainThread]: 
[0m02:00:48.241867 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m02:00:48.242448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83a01f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83a10f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff839cc10>]}
[0m02:00:48.242850 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 02:01:22.722474 | b9773c51-8023-4b61-baf0-7148013027f7 ==============================
[0m02:01:22.722474 [info ] [MainThread]: Running with dbt=1.4.7
[0m02:01:22.728110 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:01:22.728545 [debug] [MainThread]: Tracking: tracking
[0m02:01:22.745480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb20>]}
[0m02:01:22.759320 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m02:01:22.796952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:01:22.797539 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:01:22.805806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9773c51-8023-4b61-baf0-7148013027f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e54d00>]}
[0m02:01:22.818725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9773c51-8023-4b61-baf0-7148013027f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f52320>]}
[0m02:01:22.819297 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m02:01:22.819785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9773c51-8023-4b61-baf0-7148013027f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f52380>]}
[0m02:01:22.821968 [info ] [MainThread]: 
[0m02:01:22.824523 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:01:22.827781 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m02:01:22.840061 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m02:01:22.840646 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m02:01:22.841088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:01:22.892333 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m02:01:22.894757 [debug] [ThreadPool]: On list_destination_db: Close
[0m02:01:22.897621 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m02:01:22.903964 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m02:01:22.904400 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m02:01:22.904769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:01:22.910856 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:01:22.911345 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m02:01:22.911646 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:01:22.913576 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m02:01:22.915030 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m02:01:22.915881 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m02:01:22.922728 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:22.923244 [debug] [MainThread]: On master: BEGIN
[0m02:01:22.923689 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:01:22.928926 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:01:22.929439 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:22.929837 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:01:22.934042 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m02:01:22.935361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9773c51-8023-4b61-baf0-7148013027f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e910c0>]}
[0m02:01:22.935997 [debug] [MainThread]: On master: ROLLBACK
[0m02:01:22.936891 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:22.937262 [debug] [MainThread]: On master: BEGIN
[0m02:01:22.938390 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:01:22.938815 [debug] [MainThread]: On master: COMMIT
[0m02:01:22.939202 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:22.939531 [debug] [MainThread]: On master: COMMIT
[0m02:01:22.940260 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:01:22.940627 [debug] [MainThread]: On master: Close
[0m02:01:22.941401 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:01:22.942054 [info ] [MainThread]: 
[0m02:01:22.946261 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m02:01:22.946896 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m02:01:22.947785 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m02:01:22.948198 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m02:01:22.951262 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m02:01:22.953033 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-21 02:01:22.948526 => 2024-05-21 02:01:22.952924
[0m02:01:22.953507 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m02:01:22.993527 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m02:01:22.995259 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:01:22.995618 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m02:01:22.995963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:01:23.001554 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:01:23.002111 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:01:23.002385 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m02:01:23.005075 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m02:01:23.011839 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:01:23.012226 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m02:01:23.013057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:01:23.015833 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:01:23.016159 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m02:01:23.016945 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:01:23.038336 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m02:01:23.038718 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:01:23.038991 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m02:01:23.040114 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:01:23.045471 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:01:23.045870 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m02:01:23.047601 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:01:23.049122 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-21 02:01:22.953809 => 2024-05-21 02:01:23.049051
[0m02:01:23.049444 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m02:01:23.050349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9773c51-8023-4b61-baf0-7148013027f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb9bd0>]}
[0m02:01:23.051521 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 40[0m in 0.10s]
[0m02:01:23.053729 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m02:01:23.054194 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m02:01:23.054609 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m02:01:23.055368 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m02:01:23.055732 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m02:01:23.058477 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m02:01:23.059511 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-21 02:01:23.056004 => 2024-05-21 02:01:23.059448
[0m02:01:23.059837 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m02:01:23.064167 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m02:01:23.064980 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:01:23.065221 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m02:01:23.065438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:01:23.070357 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:01:23.070772 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:01:23.071179 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m02:01:23.073328 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m02:01:23.076088 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:01:23.076367 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m02:01:23.077068 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:01:23.079503 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:01:23.079805 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m02:01:23.080396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:01:23.082461 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m02:01:23.082717 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:01:23.082942 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m02:01:23.083677 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:01:23.085701 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:01:23.085946 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m02:01:23.086918 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:01:23.088067 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-21 02:01:23.060046 => 2024-05-21 02:01:23.088013
[0m02:01:23.088325 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m02:01:23.089165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9773c51-8023-4b61-baf0-7148013027f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f502e0>]}
[0m02:01:23.089770 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 40[0m in 0.03s]
[0m02:01:23.090233 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m02:01:23.090588 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m02:01:23.091041 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m02:01:23.091912 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m02:01:23.092281 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m02:01:23.096047 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m02:01:23.097176 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-21 02:01:23.092475 => 2024-05-21 02:01:23.097101
[0m02:01:23.097475 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m02:01:23.101551 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m02:01:23.102304 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:01:23.102562 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m02:01:23.102771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:01:23.107665 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:01:23.108126 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:01:23.108520 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m02:01:23.110690 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m02:01:23.113548 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:01:23.113936 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m02:01:23.114752 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:01:23.117186 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:01:23.117510 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m02:01:23.118160 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:01:23.120185 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m02:01:23.120497 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:01:23.120840 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m02:01:23.121844 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:01:23.123905 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:01:23.124230 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m02:01:23.125386 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:01:23.126743 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-21 02:01:23.097675 => 2024-05-21 02:01:23.126688
[0m02:01:23.127079 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m02:01:23.127833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9773c51-8023-4b61-baf0-7148013027f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d70fd0>]}
[0m02:01:23.128415 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 40[0m in 0.04s]
[0m02:01:23.128987 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m02:01:23.130944 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m02:01:23.131410 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m02:01:23.132218 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m02:01:23.132611 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m02:01:23.136235 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m02:01:23.137320 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-05-21 02:01:23.132893 => 2024-05-21 02:01:23.137255
[0m02:01:23.137678 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m02:01:23.141908 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m02:01:23.142845 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:01:23.143144 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m02:01:23.143429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:01:23.149117 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:01:23.149647 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:01:23.150068 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m02:01:23.154352 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m02:01:23.157297 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:01:23.157637 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings" rename to "film_ratings__dbt_backup"
[0m02:01:23.158359 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:01:23.160767 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:01:23.161131 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m02:01:23.161990 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:01:23.164192 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m02:01:23.164515 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:01:23.164789 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m02:01:23.165706 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:01:23.168707 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:01:23.169061 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m02:01:23.170432 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:01:23.171704 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-05-21 02:01:23.137959 => 2024-05-21 02:01:23.171630
[0m02:01:23.172032 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m02:01:23.172824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9773c51-8023-4b61-baf0-7148013027f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d6d4b0>]}
[0m02:01:23.173371 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 40[0m in 0.04s]
[0m02:01:23.173922 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m02:01:23.175345 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:01:23.175739 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:23.176046 [debug] [MainThread]: On master: BEGIN
[0m02:01:23.176357 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:01:23.181464 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:01:23.181973 [debug] [MainThread]: On master: COMMIT
[0m02:01:23.182341 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:23.182634 [debug] [MainThread]: On master: COMMIT
[0m02:01:23.183409 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:01:23.183808 [debug] [MainThread]: On master: Close
[0m02:01:23.184532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:01:23.184958 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m02:01:23.185676 [info ] [MainThread]: 
[0m02:01:23.186223 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m02:01:23.186938 [debug] [MainThread]: Command end result
[0m02:01:23.194266 [info ] [MainThread]: 
[0m02:01:23.194785 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:01:23.195221 [info ] [MainThread]: 
[0m02:01:23.195668 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m02:01:23.196182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cfbc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d6dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d6e470>]}
[0m02:01:23.196564 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 02:23:56.470936 | 1ca28958-ae37-4117-a90d-538ef75e2b75 ==============================
[0m02:23:56.470936 [info ] [MainThread]: Running with dbt=1.4.7
[0m02:23:56.475535 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:23:56.475958 [debug] [MainThread]: Tracking: tracking
[0m02:23:56.493291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m02:23:56.507909 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m02:23:56.546713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:23:56.547276 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:23:56.555871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ca28958-ae37-4117-a90d-538ef75e2b75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e50e50>]}
[0m02:23:56.569167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ca28958-ae37-4117-a90d-538ef75e2b75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a470>]}
[0m02:23:56.569896 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m02:23:56.570634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ca28958-ae37-4117-a90d-538ef75e2b75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a4d0>]}
[0m02:23:56.572874 [info ] [MainThread]: 
[0m02:23:56.575521 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:23:56.578673 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m02:23:56.590402 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m02:23:56.590970 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m02:23:56.591507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:23:56.642512 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m02:23:56.644734 [debug] [ThreadPool]: On list_destination_db: Close
[0m02:23:56.647780 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m02:23:56.654100 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m02:23:56.654541 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m02:23:56.654921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:23:56.661229 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:23:56.661736 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m02:23:56.662261 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:23:56.664392 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m02:23:56.665915 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m02:23:56.666831 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m02:23:56.673511 [debug] [MainThread]: Using postgres connection "master"
[0m02:23:56.674047 [debug] [MainThread]: On master: BEGIN
[0m02:23:56.674409 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:23:56.680041 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:23:56.680514 [debug] [MainThread]: Using postgres connection "master"
[0m02:23:56.680898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:23:56.685309 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m02:23:56.686596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ca28958-ae37-4117-a90d-538ef75e2b75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e991e0>]}
[0m02:23:56.687183 [debug] [MainThread]: On master: ROLLBACK
[0m02:23:56.687910 [debug] [MainThread]: Using postgres connection "master"
[0m02:23:56.688188 [debug] [MainThread]: On master: BEGIN
[0m02:23:56.689269 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:23:56.689682 [debug] [MainThread]: On master: COMMIT
[0m02:23:56.690093 [debug] [MainThread]: Using postgres connection "master"
[0m02:23:56.690438 [debug] [MainThread]: On master: COMMIT
[0m02:23:56.691087 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:23:56.691423 [debug] [MainThread]: On master: Close
[0m02:23:56.692134 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:23:56.692621 [info ] [MainThread]: 
[0m02:23:56.709461 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m02:23:56.710279 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m02:23:56.711333 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m02:23:56.711827 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m02:23:56.714943 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m02:23:56.716528 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-21 02:23:56.712189 => 2024-05-21 02:23:56.716438
[0m02:23:56.717024 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m02:23:56.757270 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m02:23:56.759179 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:23:56.759593 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m02:23:56.759952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:23:56.766301 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:23:56.766734 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:23:56.767083 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m02:23:56.770467 [debug] [Thread-1 (]: SQL status: SELECT 60 in 0 seconds
[0m02:23:56.776940 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:23:56.777265 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m02:23:56.778094 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:23:56.780593 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:23:56.780918 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m02:23:56.781655 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:23:56.802913 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m02:23:56.803254 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:23:56.803485 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m02:23:56.804656 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:23:56.810096 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:23:56.810515 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m02:23:56.812040 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:23:56.813581 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-21 02:23:56.717407 => 2024-05-21 02:23:56.813510
[0m02:23:56.813904 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m02:23:56.814892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ca28958-ae37-4117-a90d-538ef75e2b75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d14fd0>]}
[0m02:23:56.816081 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 60[0m in 0.10s]
[0m02:23:56.818029 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m02:23:56.818603 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m02:23:56.819207 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m02:23:56.820175 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m02:23:56.820667 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m02:23:56.823552 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m02:23:56.825017 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-21 02:23:56.820988 => 2024-05-21 02:23:56.824896
[0m02:23:56.825462 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m02:23:56.830291 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m02:23:56.831776 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:23:56.832073 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m02:23:56.832338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:23:56.838155 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:23:56.838624 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:23:56.839123 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m02:23:56.841638 [debug] [Thread-1 (]: SQL status: SELECT 60 in 0 seconds
[0m02:23:56.844954 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:23:56.845461 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m02:23:56.846551 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:23:56.849467 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:23:56.849937 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m02:23:56.850902 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:23:56.853299 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m02:23:56.853677 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:23:56.854039 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m02:23:56.855229 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:23:56.858738 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:23:56.859146 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m02:23:56.860438 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:23:56.861788 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-21 02:23:56.825982 => 2024-05-21 02:23:56.861719
[0m02:23:56.862131 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m02:23:56.862988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ca28958-ae37-4117-a90d-538ef75e2b75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d8c460>]}
[0m02:23:56.863898 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 60[0m in 0.04s]
[0m02:23:56.864732 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m02:23:56.865222 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m02:23:56.865662 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m02:23:56.866531 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m02:23:56.866896 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m02:23:56.869697 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m02:23:56.871024 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-21 02:23:56.867182 => 2024-05-21 02:23:56.870945
[0m02:23:56.871399 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m02:23:56.875813 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m02:23:56.876959 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:23:56.877288 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m02:23:56.877566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:23:56.884543 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:23:56.885067 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:23:56.885404 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m02:23:56.887819 [debug] [Thread-1 (]: SQL status: SELECT 60 in 0 seconds
[0m02:23:56.891054 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:23:56.891478 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m02:23:56.892312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:23:56.895208 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:23:56.895676 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m02:23:56.896495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:23:56.898738 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m02:23:56.899134 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:23:56.899477 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m02:23:56.900678 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:23:56.902925 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:23:56.903295 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m02:23:56.904929 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:23:56.906376 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-21 02:23:56.871665 => 2024-05-21 02:23:56.906318
[0m02:23:56.906743 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m02:23:56.907552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ca28958-ae37-4117-a90d-538ef75e2b75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d7de70>]}
[0m02:23:56.908169 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 60[0m in 0.04s]
[0m02:23:56.908666 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m02:23:56.910556 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m02:23:56.910967 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m02:23:56.911787 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m02:23:56.912169 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m02:23:56.915762 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m02:23:56.916940 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-05-21 02:23:56.912423 => 2024-05-21 02:23:56.916878
[0m02:23:56.917287 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m02:23:56.922134 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m02:23:56.923743 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:23:56.924168 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m02:23:56.924495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:23:56.929523 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:23:56.929974 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:23:56.930283 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m02:23:56.934867 [debug] [Thread-1 (]: SQL status: SELECT 60 in 0 seconds
[0m02:23:56.938107 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:23:56.938530 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings" rename to "film_ratings__dbt_backup"
[0m02:23:56.939391 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:23:56.942096 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:23:56.942449 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m02:23:56.943188 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:23:56.946342 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m02:23:56.946672 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:23:56.946955 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m02:23:56.947858 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:23:56.950123 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:23:56.950543 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m02:23:56.951884 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:23:56.953277 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-05-21 02:23:56.917567 => 2024-05-21 02:23:56.953218
[0m02:23:56.953683 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m02:23:56.954568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ca28958-ae37-4117-a90d-538ef75e2b75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83966e0>]}
[0m02:23:56.955127 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 60[0m in 0.04s]
[0m02:23:56.955703 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m02:23:56.957177 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:23:56.957515 [debug] [MainThread]: Using postgres connection "master"
[0m02:23:56.957797 [debug] [MainThread]: On master: BEGIN
[0m02:23:56.958056 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:23:56.963677 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:23:56.964155 [debug] [MainThread]: On master: COMMIT
[0m02:23:56.964470 [debug] [MainThread]: Using postgres connection "master"
[0m02:23:56.964779 [debug] [MainThread]: On master: COMMIT
[0m02:23:56.965510 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:23:56.965903 [debug] [MainThread]: On master: Close
[0m02:23:56.966806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:23:56.967333 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m02:23:56.968100 [info ] [MainThread]: 
[0m02:23:56.968711 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m02:23:56.969518 [debug] [MainThread]: Command end result
[0m02:23:56.977131 [info ] [MainThread]: 
[0m02:23:56.977689 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:23:56.978178 [info ] [MainThread]: 
[0m02:23:56.978606 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m02:23:56.979255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9da09d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83a0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83a0af0>]}
[0m02:23:56.979688 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 06:32:51.582829 | 097429d3-c16e-48d5-9376-4c0c84f0ac37 ==============================
[0m06:32:51.582829 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:32:51.588338 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:32:51.588723 [debug] [MainThread]: Tracking: tracking
[0m06:32:51.606266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m06:32:51.621097 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:32:51.657495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:32:51.658064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:32:51.666514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '097429d3-c16e-48d5-9376-4c0c84f0ac37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e58dc0>]}
[0m06:32:51.679734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '097429d3-c16e-48d5-9376-4c0c84f0ac37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a3e0>]}
[0m06:32:51.680264 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:32:51.680831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '097429d3-c16e-48d5-9376-4c0c84f0ac37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a440>]}
[0m06:32:51.683116 [info ] [MainThread]: 
[0m06:32:51.685862 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:32:51.688886 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:32:51.700179 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:32:51.700715 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:32:51.701109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:32:51.744053 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m06:32:51.748028 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:32:51.748618 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m06:32:51.749089 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m06:32:51.749430 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m06:32:51.749847 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m06:32:51.751348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:32:51.751718 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m06:32:51.752738 [info ] [MainThread]: 
[0m06:32:51.753207 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m06:32:51.753802 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  
[0m06:32:51.754447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e99030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e98f40>]}
[0m06:32:51.754987 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 06:33:06.464596 | a99b5b84-3c60-486f-98d7-919858a1cd6a ==============================
[0m06:33:06.464596 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:33:06.469369 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:33:06.469839 [debug] [MainThread]: Tracking: tracking
[0m06:33:06.486914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb80>]}
[0m06:33:06.501497 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:33:06.538375 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:33:06.538978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:33:06.547228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a99b5b84-3c60-486f-98d7-919858a1cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e50c70>]}
[0m06:33:06.560775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a99b5b84-3c60-486f-98d7-919858a1cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f56290>]}
[0m06:33:06.561386 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:33:06.561929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a99b5b84-3c60-486f-98d7-919858a1cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f562f0>]}
[0m06:33:06.564506 [info ] [MainThread]: 
[0m06:33:06.567339 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:33:06.570608 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:33:06.583890 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:33:06.584502 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:33:06.585011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:33:06.637542 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m06:33:06.639905 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:33:06.643055 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m06:33:06.649321 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:33:06.649769 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:33:06.650125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:33:06.656984 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m06:33:06.657467 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:33:06.657877 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:33:06.660351 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m06:33:06.661836 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:33:06.662621 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:33:06.669411 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:06.669964 [debug] [MainThread]: On master: BEGIN
[0m06:33:06.670324 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:33:06.676425 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:33:06.677092 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:06.677667 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:33:06.683042 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m06:33:06.684568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a99b5b84-3c60-486f-98d7-919858a1cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e91030>]}
[0m06:33:06.685185 [debug] [MainThread]: On master: ROLLBACK
[0m06:33:06.685967 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:06.686333 [debug] [MainThread]: On master: BEGIN
[0m06:33:06.687386 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:33:06.687790 [debug] [MainThread]: On master: COMMIT
[0m06:33:06.688144 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:06.688451 [debug] [MainThread]: On master: COMMIT
[0m06:33:06.689156 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:33:06.689521 [debug] [MainThread]: On master: Close
[0m06:33:06.690249 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:33:06.690991 [info ] [MainThread]: 
[0m06:33:06.712169 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:33:06.712942 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:33:06.713888 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m06:33:06.714396 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:33:06.717762 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:33:06.719359 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-21 06:33:06.714781 => 2024-05-21 06:33:06.719266
[0m06:33:06.719779 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:33:06.761046 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:33:06.763437 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:33:06.763883 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:33:06.764259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:33:06.770162 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:33:06.770676 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:33:06.771116 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:33:06.773602 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:33:06.780297 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:33:06.780807 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:33:06.782153 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:33:06.785023 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:33:06.785377 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:33:06.786150 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:33:06.807564 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:33:06.808011 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:33:06.808335 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:33:06.809506 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:33:06.814355 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:33:06.814810 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:33:06.816667 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:33:06.818079 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-21 06:33:06.720079 => 2024-05-21 06:33:06.817994
[0m06:33:06.818453 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:33:06.819316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a99b5b84-3c60-486f-98d7-919858a1cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d2fd60>]}
[0m06:33:06.820436 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.11s]
[0m06:33:06.822409 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:33:06.822924 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:33:06.823383 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:33:06.824306 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m06:33:06.824786 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:33:06.827564 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:33:06.828880 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-21 06:33:06.825096 => 2024-05-21 06:33:06.828802
[0m06:33:06.829273 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:33:06.833697 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:33:06.834879 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:33:06.835225 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:33:06.835556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:33:06.840966 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:33:06.841417 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:33:06.841771 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:33:06.843931 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:33:06.847071 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:33:06.847432 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:33:06.848347 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:33:06.851117 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:33:06.851572 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:33:06.852577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:33:06.854739 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:33:06.855119 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:33:06.855414 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:33:06.856487 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:33:06.859646 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:33:06.860147 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:33:06.861670 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:33:06.863108 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-21 06:33:06.829570 => 2024-05-21 06:33:06.863052
[0m06:33:06.863486 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:33:06.864567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a99b5b84-3c60-486f-98d7-919858a1cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d84160>]}
[0m06:33:06.865403 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.04s]
[0m06:33:06.866116 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:33:06.866666 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:33:06.867172 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:33:06.867967 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m06:33:06.868327 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:33:06.871193 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:33:06.872329 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-21 06:33:06.868582 => 2024-05-21 06:33:06.872268
[0m06:33:06.872674 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:33:06.876918 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:33:06.877841 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:33:06.878152 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:33:06.878452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:33:06.884184 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:33:06.884697 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:33:06.885182 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:33:06.887704 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:33:06.890697 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:33:06.891081 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:33:06.891884 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:33:06.894475 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:33:06.894818 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:33:06.895525 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:33:06.897910 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:33:06.898316 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:33:06.898689 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:33:06.899687 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:33:06.902096 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:33:06.902457 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:33:06.904039 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:33:06.905348 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-21 06:33:06.872976 => 2024-05-21 06:33:06.905288
[0m06:33:06.905697 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:33:06.906504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a99b5b84-3c60-486f-98d7-919858a1cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbd810>]}
[0m06:33:06.907071 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.04s]
[0m06:33:06.907594 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:33:06.909393 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:33:06.909820 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m06:33:06.910541 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m06:33:06.910905 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m06:33:06.914477 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m06:33:06.915713 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-05-21 06:33:06.911172 => 2024-05-21 06:33:06.915633
[0m06:33:06.916150 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m06:33:06.920719 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m06:33:06.921882 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:33:06.922198 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m06:33:06.922501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:33:06.927402 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:33:06.927796 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:33:06.928124 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m06:33:06.932476 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:33:06.935667 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:33:06.936133 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m06:33:06.936955 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:33:06.939097 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m06:33:06.939439 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:33:06.939702 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m06:33:06.940540 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:33:06.942807 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:33:06.943140 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m06:33:06.943895 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:33:06.946199 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-05-21 06:33:06.916459 => 2024-05-21 06:33:06.946145
[0m06:33:06.946541 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m06:33:06.947320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a99b5b84-3c60-486f-98d7-919858a1cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff839e680>]}
[0m06:33:06.948080 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.04s]
[0m06:33:06.948791 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:33:06.950401 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:33:06.950874 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:06.951215 [debug] [MainThread]: On master: BEGIN
[0m06:33:06.951581 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:33:06.957381 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:33:06.957846 [debug] [MainThread]: On master: COMMIT
[0m06:33:06.958193 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:06.958507 [debug] [MainThread]: On master: COMMIT
[0m06:33:06.959190 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:33:06.959545 [debug] [MainThread]: On master: Close
[0m06:33:06.960286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:33:06.960816 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m06:33:06.961633 [info ] [MainThread]: 
[0m06:33:06.962201 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m06:33:06.962950 [debug] [MainThread]: Command end result
[0m06:33:06.972439 [info ] [MainThread]: 
[0m06:33:06.973409 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:33:06.974652 [info ] [MainThread]: 
[0m06:33:06.975225 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:33:06.976403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8398160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d90e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff839ed70>]}
[0m06:33:06.976913 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 06:33:26.598343 | 852246bb-9f08-408a-8af7-74697a01fc71 ==============================
[0m06:33:26.598343 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:33:26.602976 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:33:26.603445 [debug] [MainThread]: Tracking: tracking
[0m06:33:26.620612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb20>]}
[0m06:33:26.635769 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:33:26.671510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:33:26.672048 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:33:26.679966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '852246bb-9f08-408a-8af7-74697a01fc71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e54d00>]}
[0m06:33:26.692872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '852246bb-9f08-408a-8af7-74697a01fc71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f52320>]}
[0m06:33:26.693463 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:33:26.693984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '852246bb-9f08-408a-8af7-74697a01fc71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f52380>]}
[0m06:33:26.696411 [info ] [MainThread]: 
[0m06:33:26.699092 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:33:26.702117 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:33:26.714420 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:33:26.715024 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:33:26.715429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:33:26.770412 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m06:33:26.772809 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:33:26.775839 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m06:33:26.782257 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:33:26.782686 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:33:26.783056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:33:26.789654 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m06:33:26.790265 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:33:26.790815 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:33:26.792978 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m06:33:26.794535 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:33:26.795427 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:33:26.802389 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:26.803119 [debug] [MainThread]: On master: BEGIN
[0m06:33:26.803713 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:33:26.811906 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:33:26.812463 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:26.812829 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:33:26.817502 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m06:33:26.819299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '852246bb-9f08-408a-8af7-74697a01fc71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e910c0>]}
[0m06:33:26.820127 [debug] [MainThread]: On master: ROLLBACK
[0m06:33:26.821647 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:26.822189 [debug] [MainThread]: On master: BEGIN
[0m06:33:26.823574 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:33:26.824319 [debug] [MainThread]: On master: COMMIT
[0m06:33:26.824815 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:26.825273 [debug] [MainThread]: On master: COMMIT
[0m06:33:26.826190 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:33:26.826627 [debug] [MainThread]: On master: Close
[0m06:33:26.827549 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:33:26.828127 [info ] [MainThread]: 
[0m06:33:26.832638 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:33:26.833526 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:33:26.834682 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m06:33:26.835239 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:33:26.838313 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:33:26.839934 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-21 06:33:26.835612 => 2024-05-21 06:33:26.839830
[0m06:33:26.840426 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:33:26.884028 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:33:26.885649 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:33:26.886025 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:33:26.886358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:33:26.892066 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:33:26.892513 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:33:26.892861 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:33:26.895210 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m06:33:26.901568 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:33:26.901963 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:33:26.902964 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:33:26.905992 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:33:26.906405 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:33:26.907431 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:33:26.930382 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:33:26.931009 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:33:26.931383 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:33:26.932797 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:33:26.938493 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:33:26.938927 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:33:26.940801 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:33:26.942402 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-21 06:33:26.840735 => 2024-05-21 06:33:26.942343
[0m06:33:26.942894 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:33:26.944218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '852246bb-9f08-408a-8af7-74697a01fc71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbdbd0>]}
[0m06:33:26.945504 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 40[0m in 0.11s]
[0m06:33:26.947652 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:33:26.948287 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:33:26.948817 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:33:26.949597 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m06:33:26.950058 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:33:26.953019 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:33:26.954073 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-21 06:33:26.950368 => 2024-05-21 06:33:26.953984
[0m06:33:26.954499 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:33:26.959048 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:33:26.959989 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:33:26.960273 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:33:26.960486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:33:26.965507 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:33:26.965900 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:33:26.966292 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:33:26.968423 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m06:33:26.971359 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:33:26.971735 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:33:26.972479 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:33:26.974939 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:33:26.975271 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:33:26.976236 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:33:26.978443 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:33:26.978798 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:33:26.979091 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:33:26.979961 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:33:26.982104 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:33:26.982423 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:33:26.983505 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:33:26.984788 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-21 06:33:26.954828 => 2024-05-21 06:33:26.984713
[0m06:33:26.985168 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:33:26.986053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '852246bb-9f08-408a-8af7-74697a01fc71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f50280>]}
[0m06:33:26.986787 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 40[0m in 0.04s]
[0m06:33:26.987375 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:33:26.987855 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:33:26.988347 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:33:26.989170 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m06:33:26.989569 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:33:26.993440 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:33:26.994588 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-21 06:33:26.989845 => 2024-05-21 06:33:26.994512
[0m06:33:26.994971 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:33:26.999424 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:33:27.000520 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:33:27.001029 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:33:27.001342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:33:27.006634 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:33:27.007126 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:33:27.007484 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:33:27.009821 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m06:33:27.012839 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:33:27.013238 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:33:27.014016 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:33:27.016727 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:33:27.017065 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:33:27.017806 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:33:27.019871 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:33:27.020192 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:33:27.020494 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:33:27.021309 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:33:27.023404 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:33:27.023722 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:33:27.024918 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:33:27.026360 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-21 06:33:26.995249 => 2024-05-21 06:33:27.026295
[0m06:33:27.026699 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:33:27.027479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '852246bb-9f08-408a-8af7-74697a01fc71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d70fd0>]}
[0m06:33:27.028052 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 40[0m in 0.04s]
[0m06:33:27.028573 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:33:27.030522 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:33:27.031309 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m06:33:27.032251 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m06:33:27.032693 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m06:33:27.036540 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m06:33:27.037644 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-05-21 06:33:27.033019 => 2024-05-21 06:33:27.037565
[0m06:33:27.037999 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m06:33:27.042172 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m06:33:27.043179 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:33:27.043494 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m06:33:27.043796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:33:27.050072 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:33:27.050572 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:33:27.050905 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m06:33:27.055169 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m06:33:27.058098 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:33:27.058456 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings" rename to "film_ratings__dbt_backup"
[0m06:33:27.059239 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:33:27.061849 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:33:27.062204 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m06:33:27.062994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:33:27.065158 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m06:33:27.065493 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:33:27.065773 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m06:33:27.066729 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:33:27.069736 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:33:27.070064 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m06:33:27.071377 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:33:27.072608 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-05-21 06:33:27.038236 => 2024-05-21 06:33:27.072558
[0m06:33:27.072957 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m06:33:27.073806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '852246bb-9f08-408a-8af7-74697a01fc71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d6d3f0>]}
[0m06:33:27.074354 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 40[0m in 0.04s]
[0m06:33:27.074963 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:33:27.076409 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:33:27.076816 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:27.077126 [debug] [MainThread]: On master: BEGIN
[0m06:33:27.077402 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:33:27.082778 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:33:27.083236 [debug] [MainThread]: On master: COMMIT
[0m06:33:27.083473 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:27.083764 [debug] [MainThread]: On master: COMMIT
[0m06:33:27.084351 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:33:27.084620 [debug] [MainThread]: On master: Close
[0m06:33:27.085444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:33:27.085937 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m06:33:27.086587 [info ] [MainThread]: 
[0m06:33:27.087116 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m06:33:27.087863 [debug] [MainThread]: Command end result
[0m06:33:27.095841 [info ] [MainThread]: 
[0m06:33:27.096391 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:33:27.096868 [info ] [MainThread]: 
[0m06:33:27.097300 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:33:27.097863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cfbc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d6db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d6e230>]}
[0m06:33:27.098237 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 06:37:55.352997 | a0b5c2ce-076a-451a-9063-7aa22d556a20 ==============================
[0m06:37:55.352997 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:37:55.359219 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:37:55.359811 [debug] [MainThread]: Tracking: tracking
[0m06:37:55.377690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7213c0>]}
[0m06:37:55.393004 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:37:55.431663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:37:55.432253 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:37:55.441009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0b5c2ce-076a-451a-9063-7aa22d556a20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e50ee0>]}
[0m06:37:55.454923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0b5c2ce-076a-451a-9063-7aa22d556a20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a500>]}
[0m06:37:55.455595 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:37:55.456207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0b5c2ce-076a-451a-9063-7aa22d556a20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a560>]}
[0m06:37:55.458523 [info ] [MainThread]: 
[0m06:37:55.461333 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:37:55.464493 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:37:55.477205 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:37:55.477806 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:37:55.478232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:37:55.521472 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m06:37:55.525023 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:37:55.525465 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m06:37:55.525895 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m06:37:55.526231 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m06:37:55.526585 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m06:37:55.528080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:37:55.528478 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m06:37:55.529546 [info ] [MainThread]: 
[0m06:37:55.530183 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m06:37:55.530783 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  
[0m06:37:55.531386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e99150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e99060>]}
[0m06:37:55.531901 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 06:38:25.597468 | bae67226-6cde-4424-bbf0-cd7d0aa02602 ==============================
[0m06:38:25.597468 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:38:25.603138 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:38:25.603620 [debug] [MainThread]: Tracking: tracking
[0m06:38:25.621252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m06:38:25.637051 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:38:25.673106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:25.673604 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:25.681822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bae67226-6cde-4424-bbf0-cd7d0aa02602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e54e20>]}
[0m06:38:25.694244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bae67226-6cde-4424-bbf0-cd7d0aa02602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a440>]}
[0m06:38:25.694799 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:38:25.695509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bae67226-6cde-4424-bbf0-cd7d0aa02602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a4a0>]}
[0m06:38:25.697917 [info ] [MainThread]: 
[0m06:38:25.700525 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:38:25.703446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:38:25.714950 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:38:25.715504 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:38:25.715912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:25.757957 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m06:38:25.762035 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:38:25.762505 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m06:38:25.762931 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m06:38:25.763259 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m06:38:25.763635 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m06:38:25.765047 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:25.765468 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m06:38:25.766450 [info ] [MainThread]: 
[0m06:38:25.766978 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m06:38:25.767572 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  
[0m06:38:25.768138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e99090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e98fa0>]}
[0m06:38:25.768623 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 06:44:50.095528 | ad357629-6dca-4aa3-ab89-f4485c522655 ==============================
[0m06:44:50.095528 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:44:50.101756 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:44:50.102142 [debug] [MainThread]: Tracking: tracking
[0m06:44:50.118903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m06:44:50.133410 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:44:50.171452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:44:50.171994 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:44:50.180181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad357629-6dca-4aa3-ab89-f4485c522655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e58e50>]}
[0m06:44:50.193954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad357629-6dca-4aa3-ab89-f4485c522655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a470>]}
[0m06:44:50.194568 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:44:50.195110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad357629-6dca-4aa3-ab89-f4485c522655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a4d0>]}
[0m06:44:50.197328 [info ] [MainThread]: 
[0m06:44:50.199971 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:44:50.203259 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:44:50.215557 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:44:50.216163 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:44:50.216651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:44:50.228818 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m06:44:50.231349 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:44:50.231765 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m06:44:50.232121 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m06:44:50.232443 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m06:44:50.232791 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m06:44:50.234165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:44:50.234538 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m06:44:50.235585 [info ] [MainThread]: 
[0m06:44:50.236349 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m06:44:50.237088 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m06:44:50.237766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e990c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e98fd0>]}
[0m06:44:50.238317 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 06:45:05.498446 | 03d0f838-6f53-4eb0-b575-2a7dd036735a ==============================
[0m06:45:05.498446 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:45:05.504160 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:45:05.504605 [debug] [MainThread]: Tracking: tracking
[0m06:45:05.522287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7213c0>]}
[0m06:45:05.537142 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:45:05.576402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:45:05.577011 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:45:05.586669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03d0f838-6f53-4eb0-b575-2a7dd036735a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e50df0>]}
[0m06:45:05.601834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03d0f838-6f53-4eb0-b575-2a7dd036735a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a410>]}
[0m06:45:05.602507 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:45:05.603208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03d0f838-6f53-4eb0-b575-2a7dd036735a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a470>]}
[0m06:45:05.605729 [info ] [MainThread]: 
[0m06:45:05.608650 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:45:05.611672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:45:05.623499 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:45:05.624094 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:45:05.624510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:45:05.688067 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m06:45:05.690491 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:45:05.693539 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m06:45:05.699741 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:45:05.700239 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:45:05.700606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:45:05.713618 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m06:45:05.714145 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:45:05.714551 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:45:05.717376 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m06:45:05.718907 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:45:05.719962 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:45:05.724962 [debug] [MainThread]: Using postgres connection "master"
[0m06:45:05.725477 [debug] [MainThread]: On master: BEGIN
[0m06:45:05.725870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:45:05.738319 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:45:05.738969 [debug] [MainThread]: Using postgres connection "master"
[0m06:45:05.739484 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:45:05.742408 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m06:45:05.744068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03d0f838-6f53-4eb0-b575-2a7dd036735a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e952a0>]}
[0m06:45:05.744731 [debug] [MainThread]: On master: ROLLBACK
[0m06:45:05.745554 [debug] [MainThread]: Using postgres connection "master"
[0m06:45:05.745913 [debug] [MainThread]: On master: BEGIN
[0m06:45:05.747060 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:45:05.747472 [debug] [MainThread]: On master: COMMIT
[0m06:45:05.747835 [debug] [MainThread]: Using postgres connection "master"
[0m06:45:05.748197 [debug] [MainThread]: On master: COMMIT
[0m06:45:05.748972 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:45:05.749326 [debug] [MainThread]: On master: Close
[0m06:45:05.750084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:45:05.750629 [info ] [MainThread]: 
[0m06:45:05.768652 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:45:05.769458 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:45:05.770485 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m06:45:05.771146 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:45:05.774265 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:45:05.775797 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-21 06:45:05.771497 => 2024-05-21 06:45:05.775706
[0m06:45:05.776188 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:45:05.815872 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:45:05.817809 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:45:05.818225 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:45:05.818559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:45:05.829559 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:45:05.830118 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:45:05.830455 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:45:05.831841 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m06:45:05.832276 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m06:45:05.833140 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-21 06:45:05.776462 => 2024-05-21 06:45:05.833062
[0m06:45:05.833513 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:45:05.839035 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m06:45:05.839718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03d0f838-6f53-4eb0-b575-2a7dd036735a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cde890>]}
[0m06:45:05.840802 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.07s]
[0m06:45:05.842797 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:45:05.843335 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:45:05.845612 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:45:05.846556 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m06:45:05.847052 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:45:05.849991 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:45:05.851915 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-21 06:45:05.847362 => 2024-05-21 06:45:05.851844
[0m06:45:05.852349 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:45:05.856769 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:45:05.858613 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:45:05.858952 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:45:05.859277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:45:05.871238 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:45:05.871780 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:45:05.872240 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:45:05.873133 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m06:45:05.873541 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m06:45:05.874412 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-21 06:45:05.852744 => 2024-05-21 06:45:05.874332
[0m06:45:05.874872 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:45:05.876626 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m06:45:05.877470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03d0f838-6f53-4eb0-b575-2a7dd036735a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d24d60>]}
[0m06:45:05.878233 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.03s]
[0m06:45:05.878824 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:45:05.879448 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:45:05.880075 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:45:05.880990 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m06:45:05.881463 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:45:05.884409 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:45:05.885844 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-21 06:45:05.881901 => 2024-05-21 06:45:05.885746
[0m06:45:05.886319 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:45:05.890510 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:45:05.891727 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:45:05.892038 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:45:05.892344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:45:05.903588 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:45:05.904072 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:45:05.904412 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:45:05.905288 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m06:45:05.905656 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m06:45:05.906495 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-21 06:45:05.886628 => 2024-05-21 06:45:05.906424
[0m06:45:05.906855 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:45:05.908203 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m06:45:05.908723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03d0f838-6f53-4eb0-b575-2a7dd036735a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d26980>]}
[0m06:45:05.909331 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.03s]
[0m06:45:05.909965 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:45:05.912180 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:45:05.912659 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m06:45:05.913180 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:45:05.914551 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:45:05.914993 [debug] [MainThread]: Using postgres connection "master"
[0m06:45:05.915315 [debug] [MainThread]: On master: BEGIN
[0m06:45:05.915658 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:45:05.926791 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:45:05.927499 [debug] [MainThread]: On master: COMMIT
[0m06:45:05.928012 [debug] [MainThread]: Using postgres connection "master"
[0m06:45:05.928384 [debug] [MainThread]: On master: COMMIT
[0m06:45:05.929242 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:45:05.929863 [debug] [MainThread]: On master: Close
[0m06:45:05.930722 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:45:05.931348 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m06:45:05.931771 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m06:45:05.932545 [info ] [MainThread]: 
[0m06:45:05.933098 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m06:45:05.933793 [debug] [MainThread]: Command end result
[0m06:45:05.941998 [info ] [MainThread]: 
[0m06:45:05.942652 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m06:45:05.943171 [info ] [MainThread]: 
[0m06:45:05.943642 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m06:45:05.944170 [error] [MainThread]:   relation "public.actors" does not exist
[0m06:45:05.944663 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m06:45:05.945059 [error] [MainThread]:                             ^
[0m06:45:05.945469 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m06:45:05.945838 [info ] [MainThread]: 
[0m06:45:05.946219 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m06:45:05.946534 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m06:45:05.946887 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m06:45:05.947316 [error] [MainThread]:                             ^
[0m06:45:05.947669 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m06:45:05.948062 [info ] [MainThread]: 
[0m06:45:05.948505 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m06:45:05.948891 [error] [MainThread]:   relation "public.films" does not exist
[0m06:45:05.949317 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m06:45:05.949725 [error] [MainThread]:                             ^
[0m06:45:05.950195 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m06:45:05.950737 [info ] [MainThread]: 
[0m06:45:05.951294 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m06:45:05.951873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9eb0f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e95270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ea85e0>]}
[0m06:45:05.952402 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 07:08:55.132312 | 8a6e3450-efc6-4679-9d5e-aa144a53c485 ==============================
[0m07:08:55.132312 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:08:55.140835 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:08:55.141242 [debug] [MainThread]: Tracking: tracking
[0m07:08:55.163454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7213c0>]}
[0m07:08:55.179347 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:08:55.228422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:08:55.229659 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/schema.yml
[0m07:08:55.286555 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m07:08:55.304115 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m07:08:55.311703 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m07:08:55.394282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a6e3450-efc6-4679-9d5e-aa144a53c485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8cc7fd0>]}
[0m07:08:55.406633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a6e3450-efc6-4679-9d5e-aa144a53c485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb702170>]}
[0m07:08:55.407147 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:08:55.407704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a6e3450-efc6-4679-9d5e-aa144a53c485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7020b0>]}
[0m07:08:55.409878 [info ] [MainThread]: 
[0m07:08:55.412461 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:08:55.415068 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:08:55.425960 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:08:55.426411 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:08:55.426810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:08:55.498507 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m07:08:55.500824 [debug] [ThreadPool]: On list_destination_db: Close
[0m07:08:55.504709 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m07:08:55.510708 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:08:55.511104 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m07:08:55.511445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:08:55.523773 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:08:55.524290 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:08:55.524651 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:08:55.527316 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m07:08:55.528660 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m07:08:55.529457 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m07:08:55.534800 [debug] [MainThread]: Using postgres connection "master"
[0m07:08:55.535321 [debug] [MainThread]: On master: BEGIN
[0m07:08:55.535697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:08:55.547615 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:08:55.548091 [debug] [MainThread]: Using postgres connection "master"
[0m07:08:55.548418 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:08:55.550720 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:08:55.551979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a6e3450-efc6-4679-9d5e-aa144a53c485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7043a0>]}
[0m07:08:55.552506 [debug] [MainThread]: On master: ROLLBACK
[0m07:08:55.553213 [debug] [MainThread]: Using postgres connection "master"
[0m07:08:55.553529 [debug] [MainThread]: On master: BEGIN
[0m07:08:55.554620 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:08:55.555046 [debug] [MainThread]: On master: COMMIT
[0m07:08:55.555353 [debug] [MainThread]: Using postgres connection "master"
[0m07:08:55.555630 [debug] [MainThread]: On master: COMMIT
[0m07:08:55.556312 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:08:55.556674 [debug] [MainThread]: On master: Close
[0m07:08:55.557414 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:08:55.557945 [info ] [MainThread]: 
[0m07:08:55.577812 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m07:08:55.578573 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m07:08:55.579681 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m07:08:55.580228 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m07:08:55.583145 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m07:08:55.584904 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-21 07:08:55.580592 => 2024-05-21 07:08:55.584822
[0m07:08:55.585331 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m07:08:55.626155 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m07:08:55.627932 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:08:55.628272 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m07:08:55.628591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:08:55.640141 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:08:55.640649 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:08:55.641042 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m07:08:55.642474 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m07:08:55.642934 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m07:08:55.643813 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-21 07:08:55.585622 => 2024-05-21 07:08:55.643741
[0m07:08:55.644261 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m07:08:55.650504 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m07:08:55.651242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a6e3450-efc6-4679-9d5e-aa144a53c485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d36830>]}
[0m07:08:55.652380 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.07s]
[0m07:08:55.654542 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m07:08:55.655220 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m07:08:55.656936 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m07:08:55.657766 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m07:08:55.658170 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m07:08:55.661171 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m07:08:55.664159 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-21 07:08:55.658447 => 2024-05-21 07:08:55.664080
[0m07:08:55.664653 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m07:08:55.668897 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m07:08:55.670989 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:08:55.671502 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m07:08:55.671868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:08:55.683045 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:08:55.683564 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:08:55.683901 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m07:08:55.684992 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m07:08:55.685489 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m07:08:55.686603 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-21 07:08:55.664945 => 2024-05-21 07:08:55.686520
[0m07:08:55.687202 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m07:08:55.688493 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m07:08:55.689096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a6e3450-efc6-4679-9d5e-aa144a53c485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d61ed0>]}
[0m07:08:55.689867 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.03s]
[0m07:08:55.690549 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m07:08:55.691116 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m07:08:55.691704 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m07:08:55.692603 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m07:08:55.693092 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m07:08:55.696163 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m07:08:55.697441 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-21 07:08:55.693474 => 2024-05-21 07:08:55.697366
[0m07:08:55.697828 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m07:08:55.703010 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m07:08:55.704115 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:08:55.704459 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m07:08:55.704770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:08:55.715540 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:08:55.716017 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:08:55.716361 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m07:08:55.717189 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m07:08:55.717536 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m07:08:55.718241 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-21 07:08:55.698120 => 2024-05-21 07:08:55.718176
[0m07:08:55.718565 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m07:08:55.719599 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m07:08:55.720262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a6e3450-efc6-4679-9d5e-aa144a53c485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83ff4c0>]}
[0m07:08:55.720958 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.03s]
[0m07:08:55.721613 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m07:08:55.723437 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m07:08:55.724737 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m07:08:55.725384 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m07:08:55.726836 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:08:55.727313 [debug] [MainThread]: Using postgres connection "master"
[0m07:08:55.727653 [debug] [MainThread]: On master: BEGIN
[0m07:08:55.727980 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:08:55.740061 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:08:55.740672 [debug] [MainThread]: On master: COMMIT
[0m07:08:55.741231 [debug] [MainThread]: Using postgres connection "master"
[0m07:08:55.741690 [debug] [MainThread]: On master: COMMIT
[0m07:08:55.742658 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:08:55.743186 [debug] [MainThread]: On master: Close
[0m07:08:55.744025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:08:55.744434 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m07:08:55.744759 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m07:08:55.745637 [info ] [MainThread]: 
[0m07:08:55.746256 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m07:08:55.747013 [debug] [MainThread]: Command end result
[0m07:08:55.755845 [info ] [MainThread]: 
[0m07:08:55.756464 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:08:55.756960 [info ] [MainThread]: 
[0m07:08:55.757470 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m07:08:55.757949 [error] [MainThread]:   relation "public.actors" does not exist
[0m07:08:55.758432 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m07:08:55.758858 [error] [MainThread]:                             ^
[0m07:08:55.759344 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m07:08:55.759806 [info ] [MainThread]: 
[0m07:08:55.760238 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m07:08:55.760639 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m07:08:55.761033 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m07:08:55.761458 [error] [MainThread]:                             ^
[0m07:08:55.761908 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m07:08:55.762405 [info ] [MainThread]: 
[0m07:08:55.762823 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m07:08:55.763288 [error] [MainThread]:   relation "public.films" does not exist
[0m07:08:55.763716 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m07:08:55.764152 [error] [MainThread]:                             ^
[0m07:08:55.764760 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m07:08:55.765269 [info ] [MainThread]: 
[0m07:08:55.765801 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m07:08:55.766392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb723d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb720400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb723730>]}
[0m07:08:55.766967 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 07:09:38.450700 | 6191d037-00d3-4a82-8fa2-659a771c778a ==============================
[0m07:09:38.450700 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:09:38.456127 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:09:38.456544 [debug] [MainThread]: Tracking: tracking
[0m07:09:38.473482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m07:09:38.488541 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:09:38.526130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:09:38.526649 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:09:38.535243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6191d037-00d3-4a82-8fa2-659a771c778a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e58d60>]}
[0m07:09:38.547375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6191d037-00d3-4a82-8fa2-659a771c778a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a380>]}
[0m07:09:38.547910 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:09:38.548461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6191d037-00d3-4a82-8fa2-659a771c778a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a3e0>]}
[0m07:09:38.550691 [info ] [MainThread]: 
[0m07:09:38.553239 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:09:38.556579 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:09:38.568072 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:09:38.568641 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:09:38.569030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:09:38.581261 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:09:38.586320 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:09:38.586765 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:09:38.587217 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:09:38.587575 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:09:38.587999 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m07:09:38.589623 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:09:38.590161 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m07:09:38.591283 [info ] [MainThread]: 
[0m07:09:38.591930 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m07:09:38.597447 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m07:09:38.598122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e98f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e98e50>]}
[0m07:09:38.598687 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 07:09:53.481814 | 1307c0b7-46ba-4557-a389-f0443a7424c5 ==============================
[0m07:09:53.481814 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:09:53.487587 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:09:53.488069 [debug] [MainThread]: Tracking: tracking
[0m07:09:53.505718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m07:09:53.520607 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:09:53.558646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:09:53.559260 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:09:53.568178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1307c0b7-46ba-4557-a389-f0443a7424c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e54d00>]}
[0m07:09:53.580924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1307c0b7-46ba-4557-a389-f0443a7424c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f66320>]}
[0m07:09:53.581473 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:09:53.581926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1307c0b7-46ba-4557-a389-f0443a7424c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f66380>]}
[0m07:09:53.584313 [info ] [MainThread]: 
[0m07:09:53.586834 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:09:53.590391 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:09:53.604207 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:09:53.604852 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:09:53.605355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:09:53.647886 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m07:09:53.651790 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:09:53.652275 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:09:53.652688 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:09:53.653010 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:09:53.653384 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m07:09:53.654845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:09:53.655225 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m07:09:53.656358 [info ] [MainThread]: 
[0m07:09:53.656983 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m07:09:53.657659 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  
[0m07:09:53.658315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f661d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e9f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e9fa60>]}
[0m07:09:53.658825 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 07:13:02.199523 | 1df1e62e-170f-4dbf-9726-b3da7f9f2f37 ==============================
[0m07:13:02.199523 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:13:02.205209 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:13:02.205687 [debug] [MainThread]: Tracking: tracking
[0m07:13:02.222561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb20>]}
[0m07:13:02.237587 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:13:02.276362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:13:02.276892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:13:02.285124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1df1e62e-170f-4dbf-9726-b3da7f9f2f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e54bb0>]}
[0m07:13:02.298070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1df1e62e-170f-4dbf-9726-b3da7f9f2f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ee61d0>]}
[0m07:13:02.298593 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:13:02.299236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1df1e62e-170f-4dbf-9726-b3da7f9f2f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ee6230>]}
[0m07:13:02.301428 [info ] [MainThread]: 
[0m07:13:02.304011 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:13:02.307358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:13:02.319683 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:13:02.320263 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:13:02.320725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:13:02.373783 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m07:13:02.376186 [debug] [ThreadPool]: On list_destination_db: Close
[0m07:13:02.378983 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m07:13:02.385111 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:13:02.385560 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m07:13:02.385902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:13:02.392298 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:13:02.392889 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:13:02.393289 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:13:02.395528 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m07:13:02.397241 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m07:13:02.398137 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m07:13:02.404814 [debug] [MainThread]: Using postgres connection "master"
[0m07:13:02.405343 [debug] [MainThread]: On master: BEGIN
[0m07:13:02.405716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:13:02.411150 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:13:02.411648 [debug] [MainThread]: Using postgres connection "master"
[0m07:13:02.412013 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:13:02.416481 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:13:02.417854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1df1e62e-170f-4dbf-9726-b3da7f9f2f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e93850>]}
[0m07:13:02.418432 [debug] [MainThread]: On master: ROLLBACK
[0m07:13:02.419240 [debug] [MainThread]: Using postgres connection "master"
[0m07:13:02.419613 [debug] [MainThread]: On master: BEGIN
[0m07:13:02.420765 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:13:02.421250 [debug] [MainThread]: On master: COMMIT
[0m07:13:02.421647 [debug] [MainThread]: Using postgres connection "master"
[0m07:13:02.422073 [debug] [MainThread]: On master: COMMIT
[0m07:13:02.422838 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:13:02.423212 [debug] [MainThread]: On master: Close
[0m07:13:02.423939 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:13:02.424550 [info ] [MainThread]: 
[0m07:13:02.445656 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m07:13:02.446449 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m07:13:02.447374 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m07:13:02.447876 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m07:13:02.451188 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m07:13:02.453831 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-21 07:13:02.448295 => 2024-05-21 07:13:02.453726
[0m07:13:02.454260 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m07:13:02.496611 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m07:13:02.498527 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:13:02.498994 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m07:13:02.499388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:13:02.505580 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:13:02.506079 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:13:02.506462 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m07:13:02.509115 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:13:02.516120 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:13:02.516584 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m07:13:02.517474 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:13:02.520411 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:13:02.520841 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m07:13:02.521736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:13:02.544517 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m07:13:02.545079 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:13:02.545471 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m07:13:02.546660 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:13:02.552525 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:13:02.553062 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m07:13:02.554978 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:13:02.556480 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-21 07:13:02.454578 => 2024-05-21 07:13:02.556415
[0m07:13:02.556795 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m07:13:02.557764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1df1e62e-170f-4dbf-9726-b3da7f9f2f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e85d20>]}
[0m07:13:02.558964 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.11s]
[0m07:13:02.560927 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m07:13:02.561595 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m07:13:02.562156 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m07:13:02.562996 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m07:13:02.563389 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m07:13:02.566427 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m07:13:02.567590 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-21 07:13:02.563681 => 2024-05-21 07:13:02.567520
[0m07:13:02.567940 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m07:13:02.572461 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m07:13:02.573922 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:13:02.574657 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m07:13:02.575003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:13:02.582899 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:13:02.583519 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:13:02.583979 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m07:13:02.586439 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:13:02.589594 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:13:02.590025 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m07:13:02.591083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:13:02.593750 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:13:02.594154 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m07:13:02.595174 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:13:02.598681 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m07:13:02.599220 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:13:02.599721 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m07:13:02.601128 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:13:02.603587 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:13:02.604055 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m07:13:02.605716 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:13:02.607276 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-21 07:13:02.568314 => 2024-05-21 07:13:02.607210
[0m07:13:02.607679 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m07:13:02.608678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1df1e62e-170f-4dbf-9726-b3da7f9f2f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d10d90>]}
[0m07:13:02.609389 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.05s]
[0m07:13:02.609940 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m07:13:02.610401 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m07:13:02.610907 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m07:13:02.611692 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m07:13:02.612054 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m07:13:02.614937 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m07:13:02.616103 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-21 07:13:02.612334 => 2024-05-21 07:13:02.616027
[0m07:13:02.616502 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m07:13:02.620839 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m07:13:02.621978 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:13:02.622292 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m07:13:02.622634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:13:02.628103 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:13:02.628516 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:13:02.628829 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m07:13:02.630936 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:13:02.633863 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:13:02.634216 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m07:13:02.634955 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:13:02.637575 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:13:02.637905 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m07:13:02.638618 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:13:02.640776 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m07:13:02.641114 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:13:02.641409 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m07:13:02.642741 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:13:02.645345 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:13:02.645932 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m07:13:02.648090 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:13:02.649643 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-21 07:13:02.616768 => 2024-05-21 07:13:02.649582
[0m07:13:02.650040 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m07:13:02.652368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1df1e62e-170f-4dbf-9726-b3da7f9f2f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d11bd0>]}
[0m07:13:02.653310 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.04s]
[0m07:13:02.654034 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m07:13:02.656022 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m07:13:02.656519 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m07:13:02.657386 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m07:13:02.657777 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m07:13:02.661522 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m07:13:02.662797 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-05-21 07:13:02.658076 => 2024-05-21 07:13:02.662718
[0m07:13:02.663205 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m07:13:02.668196 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m07:13:02.670010 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:13:02.670394 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m07:13:02.670718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:13:02.676743 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:13:02.677213 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:13:02.677574 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m07:13:02.681380 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:13:02.684445 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:13:02.684896 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m07:13:02.685810 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:13:02.687910 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m07:13:02.688293 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:13:02.688617 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m07:13:02.689936 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:13:02.693272 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:13:02.693890 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m07:13:02.695091 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:13:02.696699 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-05-21 07:13:02.663529 => 2024-05-21 07:13:02.696642
[0m07:13:02.697122 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m07:13:02.698022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1df1e62e-170f-4dbf-9726-b3da7f9f2f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9dabf70>]}
[0m07:13:02.698816 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.04s]
[0m07:13:02.699549 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m07:13:02.701190 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:13:02.701626 [debug] [MainThread]: Using postgres connection "master"
[0m07:13:02.701970 [debug] [MainThread]: On master: BEGIN
[0m07:13:02.702316 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:13:02.707887 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:13:02.708373 [debug] [MainThread]: On master: COMMIT
[0m07:13:02.708851 [debug] [MainThread]: Using postgres connection "master"
[0m07:13:02.709217 [debug] [MainThread]: On master: COMMIT
[0m07:13:02.709985 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:13:02.710369 [debug] [MainThread]: On master: Close
[0m07:13:02.711096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:13:02.711465 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m07:13:02.712191 [info ] [MainThread]: 
[0m07:13:02.712762 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m07:13:02.713475 [debug] [MainThread]: Command end result
[0m07:13:02.721081 [info ] [MainThread]: 
[0m07:13:02.721619 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:13:02.722057 [info ] [MainThread]: 
[0m07:13:02.722464 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m07:13:02.723013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d42830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9daba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9dab370>]}
[0m07:13:02.723425 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 07:17:09.018548 | b980356b-29f2-4638-836e-f7fd70a4880c ==============================
[0m07:17:09.018548 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:17:09.027282 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:17:09.027746 [debug] [MainThread]: Tracking: tracking
[0m07:17:09.044970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7213c0>]}
[0m07:17:09.059674 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:17:09.099534 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:17:09.100089 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:17:09.108592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b980356b-29f2-4638-836e-f7fd70a4880c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e58d30>]}
[0m07:17:09.120850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b980356b-29f2-4638-836e-f7fd70a4880c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a350>]}
[0m07:17:09.121404 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:17:09.122038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b980356b-29f2-4638-836e-f7fd70a4880c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a3b0>]}
[0m07:17:09.124455 [info ] [MainThread]: 
[0m07:17:09.127130 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:17:09.130399 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:17:09.142491 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:17:09.143130 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:17:09.143580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:17:09.204572 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m07:17:09.206929 [debug] [ThreadPool]: On list_destination_db: Close
[0m07:17:09.209789 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m07:17:09.215791 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:17:09.216261 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m07:17:09.216654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:17:09.228316 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:17:09.228897 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:17:09.229339 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:17:09.231646 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m07:17:09.233042 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m07:17:09.233927 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m07:17:09.238930 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:09.239412 [debug] [MainThread]: On master: BEGIN
[0m07:17:09.239751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:17:09.254379 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:17:09.254961 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:09.255460 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:17:09.257855 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:17:09.259236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b980356b-29f2-4638-836e-f7fd70a4880c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e99150>]}
[0m07:17:09.259811 [debug] [MainThread]: On master: ROLLBACK
[0m07:17:09.260617 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:09.260963 [debug] [MainThread]: On master: BEGIN
[0m07:17:09.262115 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:17:09.262523 [debug] [MainThread]: On master: COMMIT
[0m07:17:09.262864 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:09.263256 [debug] [MainThread]: On master: COMMIT
[0m07:17:09.264025 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:17:09.264538 [debug] [MainThread]: On master: Close
[0m07:17:09.265421 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:17:09.265938 [info ] [MainThread]: 
[0m07:17:09.283154 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m07:17:09.283839 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m07:17:09.284760 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m07:17:09.285381 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m07:17:09.288409 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m07:17:09.289815 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-21 07:17:09.285711 => 2024-05-21 07:17:09.289718
[0m07:17:09.290213 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m07:17:09.330787 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m07:17:09.332272 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:17:09.332680 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m07:17:09.333035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:09.344472 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:17:09.344991 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:17:09.345350 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m07:17:09.346808 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m07:17:09.347306 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m07:17:09.348264 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-21 07:17:09.290444 => 2024-05-21 07:17:09.348172
[0m07:17:09.348706 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m07:17:09.351245 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m07:17:09.351975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b980356b-29f2-4638-836e-f7fd70a4880c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e42080>]}
[0m07:17:09.353067 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.07s]
[0m07:17:09.355085 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m07:17:09.355614 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m07:17:09.356361 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m07:17:09.357152 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m07:17:09.357570 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m07:17:09.360514 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m07:17:09.362010 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-21 07:17:09.357892 => 2024-05-21 07:17:09.361925
[0m07:17:09.364431 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m07:17:09.368801 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m07:17:09.370439 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:17:09.371019 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m07:17:09.371324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:09.382744 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:17:09.383368 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:17:09.383789 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m07:17:09.384786 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m07:17:09.385308 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m07:17:09.386490 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-21 07:17:09.364892 => 2024-05-21 07:17:09.386377
[0m07:17:09.386953 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m07:17:09.388426 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m07:17:09.389256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b980356b-29f2-4638-836e-f7fd70a4880c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e41ea0>]}
[0m07:17:09.389998 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.03s]
[0m07:17:09.390740 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m07:17:09.391380 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m07:17:09.392010 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m07:17:09.392993 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m07:17:09.393482 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m07:17:09.396630 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m07:17:09.398148 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-21 07:17:09.393857 => 2024-05-21 07:17:09.398061
[0m07:17:09.398650 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m07:17:09.402894 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m07:17:09.404214 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:17:09.404545 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m07:17:09.404895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:09.416534 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:17:09.417048 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:17:09.417433 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m07:17:09.418482 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m07:17:09.419005 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m07:17:09.419862 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-21 07:17:09.399029 => 2024-05-21 07:17:09.419779
[0m07:17:09.420260 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m07:17:09.421576 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m07:17:09.422299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b980356b-29f2-4638-836e-f7fd70a4880c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e42560>]}
[0m07:17:09.422968 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.03s]
[0m07:17:09.423557 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m07:17:09.425736 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m07:17:09.426330 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m07:17:09.426944 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m07:17:09.428448 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:17:09.428893 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:09.429239 [debug] [MainThread]: On master: BEGIN
[0m07:17:09.429554 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:17:09.440607 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:17:09.441293 [debug] [MainThread]: On master: COMMIT
[0m07:17:09.441743 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:09.442187 [debug] [MainThread]: On master: COMMIT
[0m07:17:09.443173 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:17:09.443664 [debug] [MainThread]: On master: Close
[0m07:17:09.444540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:17:09.444951 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m07:17:09.445263 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m07:17:09.445972 [info ] [MainThread]: 
[0m07:17:09.446539 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m07:17:09.447207 [debug] [MainThread]: Command end result
[0m07:17:09.455010 [info ] [MainThread]: 
[0m07:17:09.455808 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:17:09.456455 [info ] [MainThread]: 
[0m07:17:09.456947 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m07:17:09.457401 [error] [MainThread]:   relation "public.actors" does not exist
[0m07:17:09.457827 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m07:17:09.458228 [error] [MainThread]:                             ^
[0m07:17:09.458614 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m07:17:09.459020 [info ] [MainThread]: 
[0m07:17:09.459566 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m07:17:09.460010 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m07:17:09.460415 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m07:17:09.460797 [error] [MainThread]:                             ^
[0m07:17:09.461212 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m07:17:09.461605 [info ] [MainThread]: 
[0m07:17:09.462035 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m07:17:09.462391 [error] [MainThread]:   relation "public.films" does not exist
[0m07:17:09.462733 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m07:17:09.463147 [error] [MainThread]:                             ^
[0m07:17:09.463589 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m07:17:09.464156 [info ] [MainThread]: 
[0m07:17:09.464627 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m07:17:09.465198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f99f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e59e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e99120>]}
[0m07:17:09.465658 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 07:17:19.548927 | 34c5fd99-e180-44db-aba2-7f600cad85f8 ==============================
[0m07:17:19.548927 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:17:19.553866 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:17:19.554415 [debug] [MainThread]: Tracking: tracking
[0m07:17:19.571453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb20>]}
[0m07:17:19.586071 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:17:19.623995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:17:19.624531 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:17:19.632710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34c5fd99-e180-44db-aba2-7f600cad85f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e54be0>]}
[0m07:17:19.644475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34c5fd99-e180-44db-aba2-7f600cad85f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ee6200>]}
[0m07:17:19.645019 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:17:19.645670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34c5fd99-e180-44db-aba2-7f600cad85f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ee6260>]}
[0m07:17:19.648024 [info ] [MainThread]: 
[0m07:17:19.650574 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:17:19.653293 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:17:19.665248 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:17:19.665841 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:17:19.666241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:17:19.726923 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m07:17:19.729231 [debug] [ThreadPool]: On list_destination_db: Close
[0m07:17:19.732335 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m07:17:19.738549 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:17:19.738977 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m07:17:19.739332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:17:19.751251 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:17:19.751831 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:17:19.752219 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:17:19.754648 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m07:17:19.756111 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m07:17:19.756938 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m07:17:19.762104 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:19.762587 [debug] [MainThread]: On master: BEGIN
[0m07:17:19.762929 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:17:19.773789 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:17:19.774291 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:19.774686 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:17:19.776996 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:17:19.778319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34c5fd99-e180-44db-aba2-7f600cad85f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e93730>]}
[0m07:17:19.778919 [debug] [MainThread]: On master: ROLLBACK
[0m07:17:19.779676 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:19.780024 [debug] [MainThread]: On master: BEGIN
[0m07:17:19.781050 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:17:19.781450 [debug] [MainThread]: On master: COMMIT
[0m07:17:19.781814 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:19.782129 [debug] [MainThread]: On master: COMMIT
[0m07:17:19.782891 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:17:19.783255 [debug] [MainThread]: On master: Close
[0m07:17:19.784003 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:17:19.785340 [info ] [MainThread]: 
[0m07:17:19.789581 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m07:17:19.790283 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m07:17:19.791193 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m07:17:19.791791 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m07:17:19.795043 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m07:17:19.796531 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-21 07:17:19.792252 => 2024-05-21 07:17:19.796433
[0m07:17:19.796928 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m07:17:19.837199 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m07:17:19.838840 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:17:19.839262 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m07:17:19.839618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:19.851320 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:17:19.851962 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:17:19.852715 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m07:17:19.854114 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m07:17:19.856001 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m07:17:19.857006 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-21 07:17:19.797227 => 2024-05-21 07:17:19.856924
[0m07:17:19.857427 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m07:17:19.859964 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m07:17:19.861764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c5fd99-e180-44db-aba2-7f600cad85f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e824a0>]}
[0m07:17:19.862939 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.07s]
[0m07:17:19.865133 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m07:17:19.865726 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m07:17:19.866573 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m07:17:19.867508 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m07:17:19.868070 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m07:17:19.871148 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m07:17:19.872478 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-21 07:17:19.868483 => 2024-05-21 07:17:19.872385
[0m07:17:19.872976 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m07:17:19.877396 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m07:17:19.878619 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:17:19.879010 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m07:17:19.879585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:19.892369 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:17:19.892990 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:17:19.893391 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m07:17:19.894343 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m07:17:19.894704 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m07:17:19.895471 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-21 07:17:19.873288 => 2024-05-21 07:17:19.895394
[0m07:17:19.895812 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m07:17:19.897184 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m07:17:19.897804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c5fd99-e180-44db-aba2-7f600cad85f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e81930>]}
[0m07:17:19.898487 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.03s]
[0m07:17:19.899129 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m07:17:19.899690 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m07:17:19.900361 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m07:17:19.901370 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m07:17:19.901847 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m07:17:19.904936 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m07:17:19.906654 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-21 07:17:19.902227 => 2024-05-21 07:17:19.906574
[0m07:17:19.907038 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m07:17:19.911048 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m07:17:19.912191 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:17:19.912612 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m07:17:19.912927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:19.923437 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:17:19.923953 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:17:19.924322 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m07:17:19.925282 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m07:17:19.925691 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m07:17:19.926470 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-21 07:17:19.907316 => 2024-05-21 07:17:19.926398
[0m07:17:19.926820 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m07:17:19.928258 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m07:17:19.928971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c5fd99-e180-44db-aba2-7f600cad85f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e80f70>]}
[0m07:17:19.929600 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.03s]
[0m07:17:19.930178 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m07:17:19.931955 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m07:17:19.932805 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m07:17:19.933428 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m07:17:19.935122 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:17:19.935639 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:19.936017 [debug] [MainThread]: On master: BEGIN
[0m07:17:19.936393 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:17:19.947544 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:17:19.948213 [debug] [MainThread]: On master: COMMIT
[0m07:17:19.948673 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:19.949053 [debug] [MainThread]: On master: COMMIT
[0m07:17:19.949851 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:17:19.950233 [debug] [MainThread]: On master: Close
[0m07:17:19.951011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:17:19.951362 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m07:17:19.951683 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m07:17:19.952508 [info ] [MainThread]: 
[0m07:17:19.953061 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m07:17:19.953767 [debug] [MainThread]: Command end result
[0m07:17:19.961581 [info ] [MainThread]: 
[0m07:17:19.962189 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:17:19.962645 [info ] [MainThread]: 
[0m07:17:19.963049 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m07:17:19.963484 [error] [MainThread]:   relation "public.actors" does not exist
[0m07:17:19.963901 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m07:17:19.964289 [error] [MainThread]:                             ^
[0m07:17:19.964704 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m07:17:19.965076 [info ] [MainThread]: 
[0m07:17:19.965495 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m07:17:19.966010 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m07:17:19.966533 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m07:17:19.966997 [error] [MainThread]:                             ^
[0m07:17:19.967449 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m07:17:19.967934 [info ] [MainThread]: 
[0m07:17:19.968573 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m07:17:19.969144 [error] [MainThread]:   relation "public.films" does not exist
[0m07:17:19.969677 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m07:17:19.970242 [error] [MainThread]:                             ^
[0m07:17:19.970848 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m07:17:19.971421 [info ] [MainThread]: 
[0m07:17:19.971949 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m07:17:19.972564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e93730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cef0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f040>]}
[0m07:17:19.973106 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 07:20:07.674905 | 9bd0f85b-ed36-4759-8034-14e4fa990e97 ==============================
[0m07:20:07.674905 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:20:07.686742 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:20:07.687448 [debug] [MainThread]: Tracking: tracking
[0m07:20:07.705500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb20>]}
[0m07:20:07.721431 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:20:07.763979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:20:07.764568 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:20:07.773522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bd0f85b-ed36-4759-8034-14e4fa990e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e54bb0>]}
[0m07:20:07.788046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bd0f85b-ed36-4759-8034-14e4fa990e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f561d0>]}
[0m07:20:07.788701 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:20:07.789458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bd0f85b-ed36-4759-8034-14e4fa990e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f56230>]}
[0m07:20:07.792020 [info ] [MainThread]: 
[0m07:20:07.794719 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:20:07.798896 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:20:07.812390 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:20:07.813228 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:20:07.813761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:20:07.878656 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m07:20:07.881254 [debug] [ThreadPool]: On list_destination_db: Close
[0m07:20:07.884490 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m07:20:07.890912 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:20:07.891511 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m07:20:07.891921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:20:07.904792 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:20:07.905427 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:20:07.905796 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:20:07.908579 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m07:20:07.910245 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m07:20:07.911329 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m07:20:07.916577 [debug] [MainThread]: Using postgres connection "master"
[0m07:20:07.917219 [debug] [MainThread]: On master: BEGIN
[0m07:20:07.917676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:20:07.929261 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:20:07.929938 [debug] [MainThread]: Using postgres connection "master"
[0m07:20:07.930765 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:20:07.933644 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:20:07.935159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bd0f85b-ed36-4759-8034-14e4fa990e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e938b0>]}
[0m07:20:07.935972 [debug] [MainThread]: On master: ROLLBACK
[0m07:20:07.937001 [debug] [MainThread]: Using postgres connection "master"
[0m07:20:07.937436 [debug] [MainThread]: On master: BEGIN
[0m07:20:07.938740 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:20:07.939204 [debug] [MainThread]: On master: COMMIT
[0m07:20:07.939573 [debug] [MainThread]: Using postgres connection "master"
[0m07:20:07.939901 [debug] [MainThread]: On master: COMMIT
[0m07:20:07.940707 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:20:07.941263 [debug] [MainThread]: On master: Close
[0m07:20:07.942253 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:20:07.943055 [info ] [MainThread]: 
[0m07:20:07.947786 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m07:20:07.948457 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m07:20:07.949383 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m07:20:07.949822 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m07:20:07.952750 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m07:20:07.955507 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-21 07:20:07.950147 => 2024-05-21 07:20:07.955384
[0m07:20:07.956081 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m07:20:07.997049 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m07:20:07.999067 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:20:07.999482 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m07:20:07.999854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:08.012127 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:20:08.012873 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:20:08.013373 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m07:20:08.015013 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m07:20:08.015561 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m07:20:08.016769 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-21 07:20:07.956416 => 2024-05-21 07:20:08.016667
[0m07:20:08.017243 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m07:20:08.019920 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m07:20:08.020660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd0f85b-ed36-4759-8034-14e4fa990e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e7c190>]}
[0m07:20:08.021902 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.07s]
[0m07:20:08.024077 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m07:20:08.024765 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m07:20:08.026134 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m07:20:08.027175 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m07:20:08.027822 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m07:20:08.030795 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m07:20:08.034334 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-21 07:20:08.028260 => 2024-05-21 07:20:08.034204
[0m07:20:08.034851 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m07:20:08.039144 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m07:20:08.040744 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:20:08.041183 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m07:20:08.041624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:08.054321 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:20:08.055027 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:20:08.055531 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m07:20:08.057064 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m07:20:08.057981 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m07:20:08.059769 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-21 07:20:08.035305 => 2024-05-21 07:20:08.059658
[0m07:20:08.060283 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m07:20:08.061723 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m07:20:08.062582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd0f85b-ed36-4759-8034-14e4fa990e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e7e470>]}
[0m07:20:08.063502 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.04s]
[0m07:20:08.064250 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m07:20:08.064802 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m07:20:08.065500 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m07:20:08.066457 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m07:20:08.066925 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m07:20:08.070014 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m07:20:08.071462 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-21 07:20:08.067350 => 2024-05-21 07:20:08.071383
[0m07:20:08.072030 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m07:20:08.076384 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m07:20:08.077900 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:20:08.078277 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m07:20:08.078573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:08.089904 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:20:08.090554 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:20:08.091086 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m07:20:08.092048 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m07:20:08.092397 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m07:20:08.093349 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-21 07:20:08.072432 => 2024-05-21 07:20:08.093260
[0m07:20:08.093883 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m07:20:08.095217 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m07:20:08.096118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd0f85b-ed36-4759-8034-14e4fa990e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e7e2c0>]}
[0m07:20:08.096714 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.03s]
[0m07:20:08.097308 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m07:20:08.099446 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m07:20:08.099885 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m07:20:08.100990 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m07:20:08.103028 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:20:08.103539 [debug] [MainThread]: Using postgres connection "master"
[0m07:20:08.103906 [debug] [MainThread]: On master: BEGIN
[0m07:20:08.104279 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:20:08.115735 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:20:08.116530 [debug] [MainThread]: On master: COMMIT
[0m07:20:08.117411 [debug] [MainThread]: Using postgres connection "master"
[0m07:20:08.118200 [debug] [MainThread]: On master: COMMIT
[0m07:20:08.119287 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:20:08.120003 [debug] [MainThread]: On master: Close
[0m07:20:08.120868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:20:08.121327 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m07:20:08.122266 [info ] [MainThread]: 
[0m07:20:08.123106 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m07:20:08.123872 [debug] [MainThread]: Command end result
[0m07:20:08.131998 [info ] [MainThread]: 
[0m07:20:08.132654 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:20:08.133156 [info ] [MainThread]: 
[0m07:20:08.133570 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m07:20:08.134047 [error] [MainThread]:   relation "public.actors" does not exist
[0m07:20:08.134553 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m07:20:08.134956 [error] [MainThread]:                             ^
[0m07:20:08.135342 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m07:20:08.135689 [info ] [MainThread]: 
[0m07:20:08.136140 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m07:20:08.136575 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m07:20:08.137035 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m07:20:08.137598 [error] [MainThread]:                             ^
[0m07:20:08.138067 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m07:20:08.138549 [info ] [MainThread]: 
[0m07:20:08.139058 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m07:20:08.139556 [error] [MainThread]:   relation "public.films" does not exist
[0m07:20:08.140149 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m07:20:08.140690 [error] [MainThread]:                             ^
[0m07:20:08.141208 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m07:20:08.141698 [info ] [MainThread]: 
[0m07:20:08.142168 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m07:20:08.142760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e938b0>]}
[0m07:20:08.143215 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 07:20:17.309693 | 3cb8f50d-ba64-49d0-8a75-e70d10e3a6e0 ==============================
[0m07:20:17.309693 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:20:17.315719 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:20:17.316119 [debug] [MainThread]: Tracking: tracking
[0m07:20:17.333377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb80>]}
[0m07:20:17.350351 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:20:17.389133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:20:17.389728 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:20:17.397667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cb8f50d-ba64-49d0-8a75-e70d10e3a6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e50b20>]}
[0m07:20:17.410868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cb8f50d-ba64-49d0-8a75-e70d10e3a6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f52140>]}
[0m07:20:17.411439 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:20:17.411974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cb8f50d-ba64-49d0-8a75-e70d10e3a6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f521a0>]}
[0m07:20:17.414197 [info ] [MainThread]: 
[0m07:20:17.416875 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:20:17.420113 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:20:17.434372 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:20:17.435092 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:20:17.435634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:20:17.498758 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m07:20:17.501215 [debug] [ThreadPool]: On list_destination_db: Close
[0m07:20:17.504311 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m07:20:17.510597 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:20:17.511051 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m07:20:17.511421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:20:17.523962 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:20:17.524526 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:20:17.524914 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:20:17.527241 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m07:20:17.528606 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m07:20:17.529488 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m07:20:17.534494 [debug] [MainThread]: Using postgres connection "master"
[0m07:20:17.534983 [debug] [MainThread]: On master: BEGIN
[0m07:20:17.535338 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:20:17.547699 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:20:17.548283 [debug] [MainThread]: Using postgres connection "master"
[0m07:20:17.548695 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:20:17.551304 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:20:17.552831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cb8f50d-ba64-49d0-8a75-e70d10e3a6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e93730>]}
[0m07:20:17.553564 [debug] [MainThread]: On master: ROLLBACK
[0m07:20:17.554498 [debug] [MainThread]: Using postgres connection "master"
[0m07:20:17.554887 [debug] [MainThread]: On master: BEGIN
[0m07:20:17.556129 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:20:17.556616 [debug] [MainThread]: On master: COMMIT
[0m07:20:17.557091 [debug] [MainThread]: Using postgres connection "master"
[0m07:20:17.557474 [debug] [MainThread]: On master: COMMIT
[0m07:20:17.558299 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:20:17.558675 [debug] [MainThread]: On master: Close
[0m07:20:17.559502 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:20:17.560083 [info ] [MainThread]: 
[0m07:20:17.564852 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m07:20:17.565654 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m07:20:17.566618 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m07:20:17.567127 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m07:20:17.570387 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m07:20:17.571900 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-21 07:20:17.567473 => 2024-05-21 07:20:17.571780
[0m07:20:17.572372 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m07:20:17.614786 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m07:20:17.616429 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:20:17.616798 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m07:20:17.617136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:17.628554 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:20:17.629107 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:20:17.629477 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m07:20:17.630901 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m07:20:17.631311 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m07:20:17.632321 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-21 07:20:17.572676 => 2024-05-21 07:20:17.632218
[0m07:20:17.632693 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m07:20:17.635231 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m07:20:17.636050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cb8f50d-ba64-49d0-8a75-e70d10e3a6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cd9c30>]}
[0m07:20:17.637371 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.07s]
[0m07:20:17.639493 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m07:20:17.640052 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m07:20:17.640873 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m07:20:17.641774 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m07:20:17.642226 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m07:20:17.645072 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m07:20:17.646246 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-21 07:20:17.642585 => 2024-05-21 07:20:17.646176
[0m07:20:17.646658 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m07:20:17.650867 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m07:20:17.652086 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:20:17.652496 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m07:20:17.652826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:17.663989 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:20:17.664526 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:20:17.664887 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m07:20:17.665691 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m07:20:17.666018 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m07:20:17.666873 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-21 07:20:17.646956 => 2024-05-21 07:20:17.666797
[0m07:20:17.667282 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m07:20:17.668666 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m07:20:17.669422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cb8f50d-ba64-49d0-8a75-e70d10e3a6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cd85e0>]}
[0m07:20:17.670000 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.03s]
[0m07:20:17.670555 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m07:20:17.671018 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m07:20:17.671548 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m07:20:17.672444 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m07:20:17.672844 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m07:20:17.675832 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m07:20:17.678226 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-21 07:20:17.673135 => 2024-05-21 07:20:17.678137
[0m07:20:17.678759 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m07:20:17.683243 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m07:20:17.684381 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:20:17.684737 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m07:20:17.685024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:17.695663 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:20:17.696075 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:20:17.696424 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m07:20:17.697268 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m07:20:17.697576 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m07:20:17.698337 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-21 07:20:17.679069 => 2024-05-21 07:20:17.698244
[0m07:20:17.698626 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m07:20:17.699916 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m07:20:17.700500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cb8f50d-ba64-49d0-8a75-e70d10e3a6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cd9540>]}
[0m07:20:17.701031 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.03s]
[0m07:20:17.701567 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m07:20:17.703591 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m07:20:17.704146 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m07:20:17.704764 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m07:20:17.706184 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:20:17.706649 [debug] [MainThread]: Using postgres connection "master"
[0m07:20:17.706996 [debug] [MainThread]: On master: BEGIN
[0m07:20:17.707326 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:20:17.718203 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:20:17.718761 [debug] [MainThread]: On master: COMMIT
[0m07:20:17.719174 [debug] [MainThread]: Using postgres connection "master"
[0m07:20:17.719555 [debug] [MainThread]: On master: COMMIT
[0m07:20:17.720306 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:20:17.720704 [debug] [MainThread]: On master: Close
[0m07:20:17.721414 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:20:17.721782 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m07:20:17.722135 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m07:20:17.722946 [info ] [MainThread]: 
[0m07:20:17.723516 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m07:20:17.724190 [debug] [MainThread]: Command end result
[0m07:20:17.731781 [info ] [MainThread]: 
[0m07:20:17.732386 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:20:17.732898 [info ] [MainThread]: 
[0m07:20:17.733351 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m07:20:17.733772 [error] [MainThread]:   relation "public.actors" does not exist
[0m07:20:17.734152 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m07:20:17.734608 [error] [MainThread]:                             ^
[0m07:20:17.734981 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m07:20:17.735398 [info ] [MainThread]: 
[0m07:20:17.735830 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m07:20:17.736216 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m07:20:17.736617 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m07:20:17.736998 [error] [MainThread]:                             ^
[0m07:20:17.737393 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m07:20:17.737769 [info ] [MainThread]: 
[0m07:20:17.738142 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m07:20:17.738543 [error] [MainThread]:   relation "public.films" does not exist
[0m07:20:17.738907 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m07:20:17.739280 [error] [MainThread]:                             ^
[0m07:20:17.739669 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m07:20:17.740083 [info ] [MainThread]: 
[0m07:20:17.740526 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m07:20:17.741051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e93730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e9e830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79d780>]}
[0m07:20:17.741588 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 07:21:18.672414 | 9bfdcd59-3b34-4fe6-bac3-e36ca41faec5 ==============================
[0m07:21:18.672414 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:21:18.683885 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:21:18.684375 [debug] [MainThread]: Tracking: tracking
[0m07:21:18.702372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m07:21:18.717819 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:21:18.757665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:21:18.758230 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:21:18.766713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bfdcd59-3b34-4fe6-bac3-e36ca41faec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e5cc70>]}
[0m07:21:18.780036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bfdcd59-3b34-4fe6-bac3-e36ca41faec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f66290>]}
[0m07:21:18.780761 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:21:18.781481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bfdcd59-3b34-4fe6-bac3-e36ca41faec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f662f0>]}
[0m07:21:18.784031 [info ] [MainThread]: 
[0m07:21:18.786892 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:21:18.790310 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:21:18.802627 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:21:18.803727 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:21:18.804285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:21:18.818487 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:21:18.821497 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:21:18.822695 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:21:18.823451 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:21:18.824118 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:21:18.824594 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m07:21:18.826060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:21:18.826543 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m07:21:18.827600 [info ] [MainThread]: 
[0m07:21:18.828226 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m07:21:18.828900 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m07:21:18.829592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f66140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e9f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e9fa60>]}
[0m07:21:18.830126 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 07:21:51.099774 | 542734fe-3eed-4e49-a865-0a48531435ad ==============================
[0m07:21:51.099774 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:21:51.111140 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:21:51.111548 [debug] [MainThread]: Tracking: tracking
[0m07:21:51.128357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m07:21:51.143454 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:21:51.181547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:21:51.182017 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:21:51.191008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '542734fe-3eed-4e49-a865-0a48531435ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e54d00>]}
[0m07:21:51.204016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '542734fe-3eed-4e49-a865-0a48531435ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f66320>]}
[0m07:21:51.204586 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:21:51.205166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '542734fe-3eed-4e49-a865-0a48531435ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f66380>]}
[0m07:21:51.207476 [info ] [MainThread]: 
[0m07:21:51.210108 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:21:51.213179 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:21:51.224842 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:21:51.225424 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:21:51.225859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:21:51.267771 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m07:21:51.271079 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:21:51.271551 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:21:51.271982 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:21:51.272340 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:21:51.272733 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m07:21:51.274151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:21:51.274501 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m07:21:51.275476 [info ] [MainThread]: 
[0m07:21:51.276158 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m07:21:51.276820 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  
[0m07:21:51.277463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f661d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e9f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e9fa60>]}
[0m07:21:51.277998 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 07:22:19.781665 | 835d6219-5d96-4ea6-86f9-a5cbfd31b4ff ==============================
[0m07:22:19.781665 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:22:19.787195 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:22:19.787660 [debug] [MainThread]: Tracking: tracking
[0m07:22:19.804425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb80>]}
[0m07:22:19.818645 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:22:19.857416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:22:19.857953 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:22:19.866324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '835d6219-5d96-4ea6-86f9-a5cbfd31b4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e54b20>]}
[0m07:22:19.878560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '835d6219-5d96-4ea6-86f9-a5cbfd31b4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ee2140>]}
[0m07:22:19.879213 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:22:19.879895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '835d6219-5d96-4ea6-86f9-a5cbfd31b4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ee21a0>]}
[0m07:22:19.882228 [info ] [MainThread]: 
[0m07:22:19.884876 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:22:19.887717 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:22:19.899573 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:22:19.900128 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:22:19.900665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:22:19.953688 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m07:22:19.956068 [debug] [ThreadPool]: On list_destination_db: Close
[0m07:22:19.959108 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m07:22:19.965541 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:22:19.965988 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m07:22:19.966383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:22:19.973613 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:22:19.974168 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:22:19.974552 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:22:19.976656 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m07:22:19.978223 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m07:22:19.979234 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m07:22:19.985963 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:19.986561 [debug] [MainThread]: On master: BEGIN
[0m07:22:19.986938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:22:19.992666 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:22:19.993322 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:19.993751 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:22:19.998169 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:22:19.999684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '835d6219-5d96-4ea6-86f9-a5cbfd31b4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e93850>]}
[0m07:22:20.000376 [debug] [MainThread]: On master: ROLLBACK
[0m07:22:20.001366 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:20.001751 [debug] [MainThread]: On master: BEGIN
[0m07:22:20.002906 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:22:20.003287 [debug] [MainThread]: On master: COMMIT
[0m07:22:20.003777 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:20.004278 [debug] [MainThread]: On master: COMMIT
[0m07:22:20.005041 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:22:20.005407 [debug] [MainThread]: On master: Close
[0m07:22:20.006169 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:22:20.006806 [info ] [MainThread]: 
[0m07:22:20.027679 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m07:22:20.028484 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m07:22:20.029456 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m07:22:20.029965 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m07:22:20.033114 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m07:22:20.035379 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-21 07:22:20.030314 => 2024-05-21 07:22:20.035260
[0m07:22:20.035785 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m07:22:20.077158 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m07:22:20.079210 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:22:20.079578 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m07:22:20.079916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:20.085146 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:22:20.085607 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:22:20.085941 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m07:22:20.087908 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:22:20.094511 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:22:20.094925 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m07:22:20.095794 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:22:20.098674 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:22:20.099124 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m07:22:20.099938 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:22:20.121700 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m07:22:20.122281 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:22:20.122693 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m07:22:20.124341 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:22:20.129678 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:22:20.130191 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m07:22:20.132243 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:22:20.133811 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-21 07:22:20.036070 => 2024-05-21 07:22:20.133743
[0m07:22:20.134144 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m07:22:20.135112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '835d6219-5d96-4ea6-86f9-a5cbfd31b4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e868f0>]}
[0m07:22:20.136501 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.11s]
[0m07:22:20.138561 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m07:22:20.139071 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m07:22:20.139522 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m07:22:20.140310 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m07:22:20.140630 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m07:22:20.143564 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m07:22:20.145036 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-21 07:22:20.140852 => 2024-05-21 07:22:20.144963
[0m07:22:20.145392 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m07:22:20.149718 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m07:22:20.150785 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:22:20.151034 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m07:22:20.151237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:20.156433 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:22:20.156914 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:22:20.157217 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m07:22:20.159214 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:22:20.162116 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:22:20.162471 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m07:22:20.163190 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:22:20.165715 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:22:20.166048 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m07:22:20.166830 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:22:20.169931 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m07:22:20.170299 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:22:20.170596 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m07:22:20.171482 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:22:20.173473 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:22:20.173777 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m07:22:20.175066 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:22:20.176373 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-21 07:22:20.145620 => 2024-05-21 07:22:20.176304
[0m07:22:20.176735 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m07:22:20.177634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '835d6219-5d96-4ea6-86f9-a5cbfd31b4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d13610>]}
[0m07:22:20.178336 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.04s]
[0m07:22:20.178919 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m07:22:20.179427 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m07:22:20.179890 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m07:22:20.180704 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m07:22:20.181079 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m07:22:20.183904 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m07:22:20.185177 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-21 07:22:20.181343 => 2024-05-21 07:22:20.185106
[0m07:22:20.185534 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m07:22:20.189830 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m07:22:20.191081 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:22:20.191389 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m07:22:20.191679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:20.197302 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:22:20.197770 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:22:20.198097 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m07:22:20.200415 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:22:20.203287 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:22:20.203647 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m07:22:20.204476 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:22:20.206991 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:22:20.207333 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m07:22:20.208197 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:22:20.210354 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m07:22:20.211938 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:22:20.212286 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m07:22:20.213500 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:22:20.215644 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:22:20.215966 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m07:22:20.217668 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:22:20.219150 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-21 07:22:20.185797 => 2024-05-21 07:22:20.219071
[0m07:22:20.219505 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m07:22:20.220325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '835d6219-5d96-4ea6-86f9-a5cbfd31b4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d130a0>]}
[0m07:22:20.221339 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.04s]
[0m07:22:20.221871 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m07:22:20.223792 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m07:22:20.224219 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m07:22:20.224995 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m07:22:20.225358 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m07:22:20.229081 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m07:22:20.230701 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-05-21 07:22:20.225697 => 2024-05-21 07:22:20.230636
[0m07:22:20.231053 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m07:22:20.235400 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m07:22:20.236633 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:22:20.236964 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m07:22:20.237278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:20.243534 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:22:20.243975 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:22:20.244314 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m07:22:20.248304 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:22:20.251315 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:22:20.251674 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m07:22:20.252424 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:22:20.254306 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m07:22:20.254674 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:22:20.254961 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m07:22:20.256015 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:22:20.259026 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:22:20.259343 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m07:22:20.260017 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:22:20.261515 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-05-21 07:22:20.231305 => 2024-05-21 07:22:20.261437
[0m07:22:20.261935 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m07:22:20.262748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '835d6219-5d96-4ea6-86f9-a5cbfd31b4ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9da7fa0>]}
[0m07:22:20.263347 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.04s]
[0m07:22:20.263916 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m07:22:20.265381 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:22:20.265790 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:20.266080 [debug] [MainThread]: On master: BEGIN
[0m07:22:20.266428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:22:20.271997 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:22:20.272590 [debug] [MainThread]: On master: COMMIT
[0m07:22:20.273004 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:20.273430 [debug] [MainThread]: On master: COMMIT
[0m07:22:20.274242 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:22:20.274613 [debug] [MainThread]: On master: Close
[0m07:22:20.275323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:22:20.275686 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m07:22:20.276446 [info ] [MainThread]: 
[0m07:22:20.276981 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m07:22:20.277641 [debug] [MainThread]: Command end result
[0m07:22:20.285563 [info ] [MainThread]: 
[0m07:22:20.286082 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:22:20.286558 [info ] [MainThread]: 
[0m07:22:20.286943 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m07:22:20.287427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d94340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9da73a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9da7280>]}
[0m07:22:20.287821 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 07:22:46.157918 | e0623490-1414-42e7-9710-393fec29b4cb ==============================
[0m07:22:46.157918 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:22:46.167587 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:22:46.168236 [debug] [MainThread]: Tracking: tracking
[0m07:22:46.185715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m07:22:46.201094 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:22:46.240164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:22:46.240655 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:22:46.249132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0623490-1414-42e7-9710-393fec29b4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e5cd60>]}
[0m07:22:46.261302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0623490-1414-42e7-9710-393fec29b4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a380>]}
[0m07:22:46.261862 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:22:46.262358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0623490-1414-42e7-9710-393fec29b4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a3e0>]}
[0m07:22:46.264507 [info ] [MainThread]: 
[0m07:22:46.267129 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:22:46.270061 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:22:46.281967 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:22:46.282613 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:22:46.283048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:22:46.326138 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m07:22:46.329893 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:22:46.330356 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:22:46.330807 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:22:46.331138 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:22:46.331523 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m07:22:46.333016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:22:46.333382 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m07:22:46.334377 [info ] [MainThread]: 
[0m07:22:46.334957 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m07:22:46.335536 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  
[0m07:22:46.336122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e98f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e98e50>]}
[0m07:22:46.336657 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 07:23:02.750423 | 3f360edd-2d98-4929-852e-7ec8b4094b92 ==============================
[0m07:23:02.750423 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:23:02.757511 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:23:02.757967 [debug] [MainThread]: Tracking: tracking
[0m07:23:02.776349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79ca60>]}
[0m07:23:02.792132 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:23:02.830137 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:23:02.830746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:23:02.839465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f360edd-2d98-4929-852e-7ec8b4094b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e54b80>]}
[0m07:23:02.852242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f360edd-2d98-4929-852e-7ec8b4094b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ee2170>]}
[0m07:23:02.852831 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:23:02.853522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f360edd-2d98-4929-852e-7ec8b4094b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd256620>]}
[0m07:23:02.855900 [info ] [MainThread]: 
[0m07:23:02.858661 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:23:02.862020 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:23:02.875183 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:23:02.875916 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:23:02.876517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:23:02.928418 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m07:23:02.930896 [debug] [ThreadPool]: On list_destination_db: Close
[0m07:23:02.933829 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m07:23:02.940182 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:23:02.940628 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m07:23:02.940980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:23:02.947404 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:23:02.948051 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:23:02.948589 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:23:02.950557 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m07:23:02.952101 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m07:23:02.952993 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m07:23:02.959477 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:02.959957 [debug] [MainThread]: On master: BEGIN
[0m07:23:02.960305 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:23:02.965768 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:23:02.966274 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:02.966678 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:23:02.970983 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:23:02.972457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f360edd-2d98-4929-852e-7ec8b4094b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e93850>]}
[0m07:23:02.973104 [debug] [MainThread]: On master: ROLLBACK
[0m07:23:02.973865 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:02.974219 [debug] [MainThread]: On master: BEGIN
[0m07:23:02.975505 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:23:02.975950 [debug] [MainThread]: On master: COMMIT
[0m07:23:02.976322 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:02.976657 [debug] [MainThread]: On master: COMMIT
[0m07:23:02.977368 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:23:02.977769 [debug] [MainThread]: On master: Close
[0m07:23:02.978535 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:23:02.979078 [info ] [MainThread]: 
[0m07:23:02.998732 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m07:23:02.999469 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m07:23:03.000531 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m07:23:03.001183 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m07:23:03.004596 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m07:23:03.006131 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-21 07:23:03.001595 => 2024-05-21 07:23:03.006038
[0m07:23:03.006558 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m07:23:03.050282 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m07:23:03.052119 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:23:03.052532 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m07:23:03.052873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:03.058482 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:23:03.059004 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:23:03.059394 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m07:23:03.062197 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:23:03.068848 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:23:03.069471 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m07:23:03.070478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:23:03.073573 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:23:03.073946 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m07:23:03.074811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:23:03.098236 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m07:23:03.098934 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:23:03.099351 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m07:23:03.100852 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:23:03.106274 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:23:03.106792 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m07:23:03.109366 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:23:03.111163 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-21 07:23:03.006845 => 2024-05-21 07:23:03.111102
[0m07:23:03.111990 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m07:23:03.113321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f360edd-2d98-4929-852e-7ec8b4094b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e87a30>]}
[0m07:23:03.114884 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.11s]
[0m07:23:03.116982 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m07:23:03.117774 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m07:23:03.118501 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m07:23:03.119525 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m07:23:03.120006 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m07:23:03.123088 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m07:23:03.124386 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-21 07:23:03.120346 => 2024-05-21 07:23:03.124309
[0m07:23:03.124817 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m07:23:03.129291 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m07:23:03.130683 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:23:03.131187 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m07:23:03.131712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:03.137471 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:23:03.137937 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:23:03.138262 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m07:23:03.140366 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:23:03.143346 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:23:03.143822 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m07:23:03.144763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:23:03.147488 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:23:03.147876 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m07:23:03.148906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:23:03.152314 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m07:23:03.152715 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:23:03.153036 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m07:23:03.153995 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:23:03.156072 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:23:03.156393 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m07:23:03.157924 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:23:03.159212 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-21 07:23:03.125128 => 2024-05-21 07:23:03.159152
[0m07:23:03.159565 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m07:23:03.160401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f360edd-2d98-4929-852e-7ec8b4094b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d13010>]}
[0m07:23:03.160970 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.04s]
[0m07:23:03.161549 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m07:23:03.161997 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m07:23:03.162457 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m07:23:03.163183 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m07:23:03.163524 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m07:23:03.166510 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m07:23:03.167755 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-21 07:23:03.163852 => 2024-05-21 07:23:03.167663
[0m07:23:03.168144 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m07:23:03.172472 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m07:23:03.173448 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:23:03.173757 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m07:23:03.174068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:03.181119 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:23:03.181580 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:23:03.181984 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m07:23:03.184521 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:23:03.187528 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:23:03.187952 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m07:23:03.188923 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:23:03.191620 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:23:03.192021 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m07:23:03.192935 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:23:03.195151 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m07:23:03.195517 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:23:03.195820 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m07:23:03.197858 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:23:03.200209 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:23:03.200619 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m07:23:03.202355 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:23:03.203730 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-21 07:23:03.168431 => 2024-05-21 07:23:03.203674
[0m07:23:03.204080 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m07:23:03.204939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f360edd-2d98-4929-852e-7ec8b4094b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d11d80>]}
[0m07:23:03.205585 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.04s]
[0m07:23:03.206173 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m07:23:03.208074 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m07:23:03.208554 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m07:23:03.209333 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m07:23:03.209827 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m07:23:03.213680 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m07:23:03.215067 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-05-21 07:23:03.210220 => 2024-05-21 07:23:03.214984
[0m07:23:03.215518 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m07:23:03.220041 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m07:23:03.221110 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:23:03.221465 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m07:23:03.221774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:03.227784 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:23:03.228244 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:23:03.228597 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m07:23:03.232505 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:23:03.235569 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:23:03.235976 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m07:23:03.236898 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:23:03.238850 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m07:23:03.239204 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:23:03.239514 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m07:23:03.240701 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:23:03.243863 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:23:03.244280 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m07:23:03.245137 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:23:03.246469 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-05-21 07:23:03.215828 => 2024-05-21 07:23:03.246399
[0m07:23:03.246841 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m07:23:03.247893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f360edd-2d98-4929-852e-7ec8b4094b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9da7fa0>]}
[0m07:23:03.248770 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.04s]
[0m07:23:03.249340 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m07:23:03.250809 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:23:03.251238 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:03.251570 [debug] [MainThread]: On master: BEGIN
[0m07:23:03.251881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:23:03.257855 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:23:03.258457 [debug] [MainThread]: On master: COMMIT
[0m07:23:03.258938 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:03.259288 [debug] [MainThread]: On master: COMMIT
[0m07:23:03.260077 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:23:03.260464 [debug] [MainThread]: On master: Close
[0m07:23:03.261205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:23:03.261586 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m07:23:03.262301 [info ] [MainThread]: 
[0m07:23:03.262827 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m07:23:03.263542 [debug] [MainThread]: Command end result
[0m07:23:03.270974 [info ] [MainThread]: 
[0m07:23:03.271664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:23:03.272216 [info ] [MainThread]: 
[0m07:23:03.272823 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m07:23:03.273390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d943a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d3e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9da7460>]}
[0m07:23:03.273823 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 07:59:28.254563 | 50f52979-8b40-4630-aec2-9d74eda9e69f ==============================
[0m07:59:28.254563 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:59:28.264454 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:59:28.264967 [debug] [MainThread]: Tracking: tracking
[0m07:59:28.282389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb20>]}
[0m07:59:28.297319 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:59:28.339195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:59:28.339698 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:59:28.347870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50f52979-8b40-4630-aec2-9d74eda9e69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e54bb0>]}
[0m07:59:28.362317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50f52979-8b40-4630-aec2-9d74eda9e69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f521d0>]}
[0m07:59:28.363005 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:59:28.363625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50f52979-8b40-4630-aec2-9d74eda9e69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f52230>]}
[0m07:59:28.366061 [info ] [MainThread]: 
[0m07:59:28.368819 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:59:28.371862 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:59:28.383929 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:59:28.384541 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:59:28.384962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:59:28.438356 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m07:59:28.440893 [debug] [ThreadPool]: On list_destination_db: Close
[0m07:59:28.444251 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m07:59:28.450830 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:59:28.451391 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m07:59:28.451819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:59:28.459062 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:59:28.459600 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:59:28.459950 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:59:28.462895 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m07:59:28.464529 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m07:59:28.465385 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m07:59:28.472417 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:28.473025 [debug] [MainThread]: On master: BEGIN
[0m07:59:28.473567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:59:28.480223 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:59:28.480796 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:28.481192 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:59:28.486477 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:59:28.487929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50f52979-8b40-4630-aec2-9d74eda9e69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e93850>]}
[0m07:59:28.488583 [debug] [MainThread]: On master: ROLLBACK
[0m07:59:28.489396 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:28.489757 [debug] [MainThread]: On master: BEGIN
[0m07:59:28.490930 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:59:28.491314 [debug] [MainThread]: On master: COMMIT
[0m07:59:28.491677 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:28.492016 [debug] [MainThread]: On master: COMMIT
[0m07:59:28.492744 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:59:28.493084 [debug] [MainThread]: On master: Close
[0m07:59:28.493815 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:59:28.494361 [info ] [MainThread]: 
[0m07:59:28.498848 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m07:59:28.499574 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m07:59:28.500524 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m07:59:28.501054 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m07:59:28.504041 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m07:59:28.506160 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-21 07:59:28.501383 => 2024-05-21 07:59:28.506039
[0m07:59:28.506644 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m07:59:28.546583 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m07:59:28.548749 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:59:28.549096 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m07:59:28.549430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:28.555180 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:59:28.555700 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:59:28.556065 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m07:59:28.558822 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m07:59:28.565481 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:59:28.565945 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m07:59:28.566837 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:59:28.569842 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:59:28.570211 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m07:59:28.571032 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:59:28.592326 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m07:59:28.592775 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:59:28.593091 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m07:59:28.594291 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:59:28.599193 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:59:28.599567 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m07:59:28.601198 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:59:28.602649 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-21 07:59:28.506972 => 2024-05-21 07:59:28.602585
[0m07:59:28.603022 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m07:59:28.603925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50f52979-8b40-4630-aec2-9d74eda9e69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb9bd0>]}
[0m07:59:28.605046 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 40[0m in 0.10s]
[0m07:59:28.607121 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m07:59:28.607791 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m07:59:28.608447 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m07:59:28.609452 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m07:59:28.609870 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m07:59:28.612717 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m07:59:28.614237 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-21 07:59:28.610145 => 2024-05-21 07:59:28.614164
[0m07:59:28.614621 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m07:59:28.618951 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m07:59:28.620297 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:59:28.620676 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m07:59:28.621047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:28.627242 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:59:28.627745 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:59:28.628147 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m07:59:28.630402 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m07:59:28.633338 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:59:28.633733 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m07:59:28.634527 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:59:28.637074 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:59:28.637396 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m07:59:28.638159 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:59:28.640318 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m07:59:28.640669 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:59:28.640973 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m07:59:28.642000 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:59:28.645024 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:59:28.645354 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m07:59:28.646484 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:59:28.647763 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-21 07:59:28.614932 => 2024-05-21 07:59:28.647701
[0m07:59:28.648093 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m07:59:28.649044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50f52979-8b40-4630-aec2-9d74eda9e69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d77430>]}
[0m07:59:28.649768 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 40[0m in 0.04s]
[0m07:59:28.650437 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m07:59:28.650983 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m07:59:28.651466 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m07:59:28.652304 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m07:59:28.652707 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m07:59:28.655552 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m07:59:28.656927 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-21 07:59:28.652967 => 2024-05-21 07:59:28.656863
[0m07:59:28.657261 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m07:59:28.661440 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m07:59:28.662784 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:59:28.663121 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m07:59:28.663435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:28.670098 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:59:28.670553 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:59:28.670883 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m07:59:28.673070 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m07:59:28.676140 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:59:28.676553 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m07:59:28.677375 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:59:28.680333 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:59:28.680696 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m07:59:28.681437 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:59:28.683605 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m07:59:28.683944 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:59:28.684273 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m07:59:28.685315 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:59:28.687429 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:59:28.687826 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m07:59:28.689071 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:59:28.690377 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-21 07:59:28.657505 => 2024-05-21 07:59:28.690305
[0m07:59:28.690736 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m07:59:28.691552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50f52979-8b40-4630-aec2-9d74eda9e69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d76cb0>]}
[0m07:59:28.692187 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 40[0m in 0.04s]
[0m07:59:28.692775 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m07:59:28.694649 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m07:59:28.695058 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m07:59:28.695807 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m07:59:28.696163 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m07:59:28.699703 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m07:59:28.701106 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-05-21 07:59:28.696428 => 2024-05-21 07:59:28.701038
[0m07:59:28.701456 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m07:59:28.705738 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m07:59:28.707022 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:59:28.707372 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m07:59:28.707671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:28.713842 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:59:28.714307 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:59:28.714649 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m07:59:28.719139 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m07:59:28.722159 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:59:28.722572 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings" rename to "film_ratings__dbt_backup"
[0m07:59:28.723389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:59:28.727031 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:59:28.727424 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m07:59:28.728239 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:59:28.730342 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m07:59:28.730718 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:59:28.731095 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m07:59:28.732164 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:59:28.734530 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:59:28.734961 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m07:59:28.736534 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:59:28.737919 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-05-21 07:59:28.701742 => 2024-05-21 07:59:28.737862
[0m07:59:28.738258 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m07:59:28.739063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50f52979-8b40-4630-aec2-9d74eda9e69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9db0250>]}
[0m07:59:28.739702 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 40[0m in 0.04s]
[0m07:59:28.740302 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m07:59:28.741945 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:59:28.742649 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:28.743050 [debug] [MainThread]: On master: BEGIN
[0m07:59:28.743438 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:59:28.753677 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:59:28.754743 [debug] [MainThread]: On master: COMMIT
[0m07:59:28.755322 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:28.755742 [debug] [MainThread]: On master: COMMIT
[0m07:59:28.756636 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:59:28.757021 [debug] [MainThread]: On master: Close
[0m07:59:28.757773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:59:28.758166 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m07:59:28.758958 [info ] [MainThread]: 
[0m07:59:28.759488 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m07:59:28.760210 [debug] [MainThread]: Command end result
[0m07:59:28.772942 [info ] [MainThread]: 
[0m07:59:28.773624 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:59:28.774220 [info ] [MainThread]: 
[0m07:59:28.774778 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m07:59:28.775378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff839abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d98640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9da7430>]}
[0m07:59:28.775846 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 08:02:16.517660 | 4aa83e7f-845e-454c-ad61-ae41ff457c70 ==============================
[0m08:02:16.517660 [info ] [MainThread]: Running with dbt=1.4.7
[0m08:02:16.529889 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:02:16.530304 [debug] [MainThread]: Tracking: tracking
[0m08:02:16.547292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cb20>]}
[0m08:02:16.562023 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m08:02:16.595467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:02:16.595907 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:02:16.603753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4aa83e7f-845e-454c-ad61-ae41ff457c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e58bb0>]}
[0m08:02:16.616573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4aa83e7f-845e-454c-ad61-ae41ff457c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f521d0>]}
[0m08:02:16.617122 [info ] [MainThread]: Found 4 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m08:02:16.617744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4aa83e7f-845e-454c-ad61-ae41ff457c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f52230>]}
[0m08:02:16.619974 [info ] [MainThread]: 
[0m08:02:16.622460 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:02:16.625705 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m08:02:16.638193 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m08:02:16.638780 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m08:02:16.639236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:02:16.690186 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m08:02:16.692542 [debug] [ThreadPool]: On list_destination_db: Close
[0m08:02:16.695377 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m08:02:16.701678 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m08:02:16.702099 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m08:02:16.702456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:02:16.708837 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m08:02:16.709437 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m08:02:16.710007 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m08:02:16.712077 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m08:02:16.713649 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m08:02:16.714594 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m08:02:16.721269 [debug] [MainThread]: Using postgres connection "master"
[0m08:02:16.721724 [debug] [MainThread]: On master: BEGIN
[0m08:02:16.722040 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:02:16.727349 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:02:16.727836 [debug] [MainThread]: Using postgres connection "master"
[0m08:02:16.728322 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:02:16.733613 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m08:02:16.734985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4aa83e7f-845e-454c-ad61-ae41ff457c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e93850>]}
[0m08:02:16.735658 [debug] [MainThread]: On master: ROLLBACK
[0m08:02:16.736466 [debug] [MainThread]: Using postgres connection "master"
[0m08:02:16.736819 [debug] [MainThread]: On master: BEGIN
[0m08:02:16.737874 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:02:16.738360 [debug] [MainThread]: On master: COMMIT
[0m08:02:16.738823 [debug] [MainThread]: Using postgres connection "master"
[0m08:02:16.739228 [debug] [MainThread]: On master: COMMIT
[0m08:02:16.739969 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m08:02:16.740351 [debug] [MainThread]: On master: Close
[0m08:02:16.741136 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:02:16.741675 [info ] [MainThread]: 
[0m08:02:16.745770 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m08:02:16.746475 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m08:02:16.747426 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m08:02:16.747938 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m08:02:16.751006 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m08:02:16.752570 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-21 08:02:16.748289 => 2024-05-21 08:02:16.752444
[0m08:02:16.753080 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m08:02:16.795183 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m08:02:16.796898 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m08:02:16.797286 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m08:02:16.797642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:16.803210 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:02:16.803730 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m08:02:16.804222 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m08:02:16.806485 [debug] [Thread-1 (]: SQL status: SELECT 60 in 0 seconds
[0m08:02:16.813097 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m08:02:16.813544 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m08:02:16.814387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:02:16.816977 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m08:02:16.817338 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m08:02:16.818123 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:02:16.839211 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m08:02:16.839653 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m08:02:16.840012 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m08:02:16.841382 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:02:16.846472 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m08:02:16.846973 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m08:02:16.848667 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:02:16.850115 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-21 08:02:16.753367 => 2024-05-21 08:02:16.850049
[0m08:02:16.850474 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m08:02:16.851428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aa83e7f-845e-454c-ad61-ae41ff457c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb9bd0>]}
[0m08:02:16.852491 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 60[0m in 0.10s]
[0m08:02:16.854536 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m08:02:16.855032 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m08:02:16.855497 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m08:02:16.856307 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m08:02:16.856697 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m08:02:16.859359 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m08:02:16.860578 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-21 08:02:16.856965 => 2024-05-21 08:02:16.860511
[0m08:02:16.860957 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m08:02:16.865352 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m08:02:16.866278 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m08:02:16.866585 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m08:02:16.866873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:16.872426 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:02:16.872884 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m08:02:16.873255 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m08:02:16.875532 [debug] [Thread-1 (]: SQL status: SELECT 60 in 0 seconds
[0m08:02:16.878356 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m08:02:16.878721 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m08:02:16.879516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:02:16.882063 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m08:02:16.882408 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m08:02:16.883120 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:02:16.885309 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m08:02:16.885631 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m08:02:16.885914 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m08:02:16.886820 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:02:16.889826 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m08:02:16.890188 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m08:02:16.891351 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:02:16.892589 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-21 08:02:16.861268 => 2024-05-21 08:02:16.892535
[0m08:02:16.892949 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m08:02:16.893774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aa83e7f-845e-454c-ad61-ae41ff457c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d77430>]}
[0m08:02:16.894556 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 60[0m in 0.04s]
[0m08:02:16.895260 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m08:02:16.895801 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m08:02:16.896301 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m08:02:16.897149 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m08:02:16.897560 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m08:02:16.900491 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m08:02:16.901600 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-21 08:02:16.897859 => 2024-05-21 08:02:16.901514
[0m08:02:16.901998 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m08:02:16.906092 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m08:02:16.907023 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m08:02:16.907338 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m08:02:16.907781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:16.914838 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:02:16.915286 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m08:02:16.915543 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m08:02:16.917628 [debug] [Thread-1 (]: SQL status: SELECT 60 in 0 seconds
[0m08:02:16.920428 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m08:02:16.920699 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m08:02:16.921343 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:02:16.923781 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m08:02:16.924057 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m08:02:16.924628 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:02:16.926648 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m08:02:16.926916 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m08:02:16.927154 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m08:02:16.928022 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:02:16.930019 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m08:02:16.930312 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m08:02:16.931426 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:02:16.932608 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-21 08:02:16.902265 => 2024-05-21 08:02:16.932556
[0m08:02:16.932859 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m08:02:16.933749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aa83e7f-845e-454c-ad61-ae41ff457c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d76cb0>]}
[0m08:02:16.934377 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 60[0m in 0.04s]
[0m08:02:16.934961 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m08:02:16.937032 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m08:02:16.937540 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m08:02:16.938387 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m08:02:16.938762 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m08:02:16.942538 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m08:02:16.943434 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-05-21 08:02:16.938972 => 2024-05-21 08:02:16.943368
[0m08:02:16.943709 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m08:02:16.948081 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m08:02:16.948802 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m08:02:16.949080 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m08:02:16.949328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:16.955814 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:02:16.956318 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m08:02:16.956670 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m08:02:16.961692 [debug] [Thread-1 (]: SQL status: SELECT 60 in 0 seconds
[0m08:02:16.964662 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m08:02:16.965005 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings" rename to "film_ratings__dbt_backup"
[0m08:02:16.965903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:02:16.969641 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m08:02:16.970017 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m08:02:16.970792 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:02:16.972842 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m08:02:16.973170 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m08:02:16.973460 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m08:02:16.974333 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:02:16.976444 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m08:02:16.976824 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m08:02:16.978231 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:02:16.979594 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-05-21 08:02:16.943896 => 2024-05-21 08:02:16.979532
[0m08:02:16.979965 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m08:02:16.980726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aa83e7f-845e-454c-ad61-ae41ff457c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9db0250>]}
[0m08:02:16.981746 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 60[0m in 0.04s]
[0m08:02:16.982309 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m08:02:16.983862 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:02:16.984283 [debug] [MainThread]: Using postgres connection "master"
[0m08:02:16.984603 [debug] [MainThread]: On master: BEGIN
[0m08:02:16.984912 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:02:16.989869 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:02:16.990336 [debug] [MainThread]: On master: COMMIT
[0m08:02:16.990676 [debug] [MainThread]: Using postgres connection "master"
[0m08:02:16.990986 [debug] [MainThread]: On master: COMMIT
[0m08:02:16.991702 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m08:02:16.992106 [debug] [MainThread]: On master: Close
[0m08:02:16.992821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:02:16.993170 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m08:02:16.993887 [info ] [MainThread]: 
[0m08:02:16.994371 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m08:02:16.995000 [debug] [MainThread]: Command end result
[0m08:02:17.002360 [info ] [MainThread]: 
[0m08:02:17.003036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:02:17.003418 [info ] [MainThread]: 
[0m08:02:17.003816 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:02:17.004355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff839af80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d98640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9da7430>]}
[0m08:02:17.004751 [debug] [MainThread]: Flushing usage events
